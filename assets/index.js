(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();(function(n){const[e,t,r,s,a,l,c]=Array.from(Array(7),Symbol),_="dlcomponent",p={};function O(){return`${Array(4).fill(0).map(()=>Math.floor(36*Math.random()).toString(36)).join("")}`}const D=w=>function(I,...H){let j="";for(let L of I)j+=L+(H.shift()||"");return P("dl"+O(),j,w)},$=D(!1),b=D(!0);function P(w,I,H){let j=p[I];if(j)return j;p[I]=w;const L=document.createElement("style");document.head.appendChild(L);let y="",W="";for(I+=`
`;;){let[C,...N]=I.split(`
`);if(C.trim().endsWith("{")||(W+=C+`
`,!(I=N.join(`
`))))break}L.textContent=I;let q=!0;if(q=!!window.CSSScopeRule,H&&q){let C="";for(const N of L.sheet.cssRules)N.selectorText||N.media?N.selectorText?.startsWith(":")?(N.selectorText=`.${w}${N.selectorText}`,C+=N.cssText):y+=N.cssText:C+=N.cssText;L.textContent=`.${w} {${W}} @scope (.${w}) to (:not(.${w}).${_} *) { ${y} } ${C}`}else{let C="";H&&!q&&(C=function(U){let V=`:not(${U}).${_}`,ne=(re,Q)=>`${re} *${Q>50?"":`:not(${ne(re+" "+(Q%2==0?U:V),Q+1)})`}`;return`:not(${ne(V,0)})`}(`.${w}`));const N=U=>{U.selectorText&&(U.selectorText=U.selectorText.split(",").map(V=>(V=V.trim())[0]==="&"?`.${w}${V.slice(1)}${C}`:V[0]===":"?`.${w}${V}${C}`:`.${w} ${V}${C}`).join(", ")),y+=U.cssText};for(const U of L.sheet.cssRules)U.media&&U.media.mediaText?(y+=`@media(${U.media.mediaText}){`,Array.from(U.cssRules).map(N),y+="}"):N(U);L.textContent=`.${w} {${W}}${y}`}return w}let B=document;const x=Symbol();let z=!1;Object.defineProperty(window,"use",{get:()=>(z=!0,(w,I,...H)=>{if(w instanceof Array)return K(w,I,...H);F(w)||k(w),z=!1;let j={get value(){return function(L){let y=L[r],W=y[s],q=L[e],C=y[t];for(let N of W)if(C=C[N],!m(C))break;for(let N of q)C=N(C);return C}(j)}};if(k(w)){let L=[...w[e]];I&&L.push(I),j[r]=w[r],j[e]=L}else j[r]=w,j[e]=I?[I]:[];return j})}),Object.defineProperty(window,"useChange",{get:()=>(z=!0,(w,I)=>{z=!1,w=w instanceof Array?w:[w];for(let H of w)F(H)||k(H),u(use(H),I)})});const K=(w,...I)=>{z=!1;let H=v({});const j=[];for(const L in w)if(j.push(w[L]),I[L]){let y=I[L];if(F(y)&&(y=use(y)),k(y)){const W=j.length;let q;u(use(y),C=>{j[W]=String(C);let N=j.join("");N!=q&&(H.string=N),q=N})}else j.push(String(y))}return H.string=j.join(""),use(H.string)};let se=new Map;function v(w){m(w),w[a]=[],w[t]=w;let I=Symbol.toPrimitive;return new Proxy(w,{get(j,L,y){if(z){let W=Symbol(),q=new Proxy({[t]:j,[r]:y,[s]:[L],[I]:()=>W},{get:(C,N)=>[t,r,s,e,I].includes(N)?C[N]:(N=se.get(N)||N,C[s].push(N),q)});return se.set(W,q),q}return Reflect.get(j,L,y)},set(j,L,y){let W=Reflect.set(j,L,y);for(let q of j[a])q(j,L,y);return j[c]&&j[c](j,L,j[L]),W}})}let m=w=>w instanceof Object;function S(w){return m(w)&&a in w}function F(w){return m(w)&&s in w}function k(w){return m(w)&&e in w}function g(w){return w[e].length!=0}function u(w,I){k(w);let H,j=w[r],L=w[e],y=[];function W(){let N=j[t];for(H of y)if(N=N[H],!m(N))break;for(let U of L)N=U(N);I(N)}let q=(N,U)=>function V(ne,re,Q){if(re===y[U]&&N===ne&&(W(),m(Q))){let ce=Q[a];ce&&!ce.includes(V)&&ce.push(q(Q[t],U+1))}};for(let N in j[s]){let U=j[s][N];m(U)&&U[t]?u(U,V=>{y[N]=V,W()}):y[N]=U}let C=q(j[t],0);j[t][a].push(C),C(j[t],y[0],j[t][y[0]])}function T(w,I,H){let j,L,y,W;u(w,q=>{y=L?.[0],y&&(j=y.previousSibling||(W=y.parentNode)),L&&L.forEach(C=>C.remove()),L=te(H?q?H.then:H.otherwise:q,C=>{j?(W?(j.prepend(C),W=null):j.after(C),j=C):I(C)})})}let M=w=>I=>{let H=w[r],j=w[s],L=0;for(;L<j.length-1;L++)if(H=H[j[L]],!m(H))return;H[j[L]]=I};function J(w,I,...H){if(w==x)return H;if(typeof w=="function"){let y=v(Object.create(w.prototype));for(let U in I){let V=I[U];if(U.startsWith("bind:")){k(V),g(V);let ne=M(V[r]),re=U.substring(5);if(re=="this")ne(y);else{let Q=!1;u(V,ce=>{Q?Q=!1:(Q=!0,y[re]=ce)}),u(use(y[re]),ce=>{Q?Q=!1:(Q=!0,ne(ce))})}delete I[U]}else k(V)&&(u(V,ne=>y[U]=ne),delete I[U])}Object.assign(y,I),y.children=[];for(let U of H)te(U,y.children.push.bind(y.children));let W=w.apply(y);W.$=y,y.root=W;let q=W.classList,C=y.css,N=w.name.replace(/\$/g,"-");return C&&q.add(P(`${N}-${O()}`,C,!0)),y._leak||q.add(_),W.setAttribute("data-component",w.name),typeof y.mount=="function"&&y.mount(),W}let j=I?.xmlns,L=j?B.createElementNS(j,w):B.createElement(w);for(let y of H)te(y,L.append.bind(L));if(!I)return L;((y,W)=>{y in I&&(W(I[y]),delete I[y])})("class",y=>{if(typeof y=="string"||y instanceof Array||k(y),typeof y!="string")if(k(y)){let W="";u(y,q=>{for(let C of W.split(" "))C&&L.classList.remove(C);if(typeof q=="string"){for(let C of q.split(" "))C&&L.classList.add(C);W=q}})}else for(let W of y)if(k(W)){let q=null;u(W,C=>{typeof q=="string"&&L.classList.remove(q),L.classList.add(C),q=C})}else L.classList.add(W);else L.setAttribute("class",y)});for(let y in I){let W=I[y];if(y.startsWith("bind:")){k(W),g(W);let q=y.substring(5),C=M(W[r]);q=="this"?C(L):q=="value"?(u(W,N=>L.value=N),L.addEventListener("change",()=>C(L.value))):q=="checked"&&(u(W,N=>L.checked=N),L.addEventListener("click",()=>C(L.checked))),delete I[y]}if(y.startsWith("class:")){let q=y.substring(6);k(W)?u(W,C=>{C?L.classList.add(q):L.classList.remove(q)}):W&&L.classList.add(q),delete I[y]}if(y=="style"&&m(W)&&!k(W)){for(let q in W){let C=S(W)?use(W[q]):W[q];k(C)?u(C,N=>L.style[q]=N):L.style[q]=C}delete I[y]}}for(let y in I){let W=I[y];k(W)?u(W,q=>{de(L,y,q)}):de(L,y,W)}return j&&(L.innerHTML=L.innerHTML),L}function te(w,I){let H,j,L;if(k(w))T(w,I);else{if(!m(w)||!(l in w)){if(w instanceof Node)return I(w),[w];if(w instanceof Array){for(H of(j=[],w))j=j.concat(te(H,I));return j[0]||(j=te("",I)),j}return w==null&&(w=""),L=B.createTextNode(w),I(L),[L]}T(w[l],I,w)}}function de(w,I,H){if(!H&&w.hasAttribute(I)&&w.removeAttribute(I),H)if(I.startsWith("on:")){let j=I.substring(3);for(let L of j.split("$"))w.addEventListener(L,(...y)=>{self.$el=w,H(...y)})}else w.setAttribute(I,H)}n.$if=function(w,I,H){return H??=B.createTextNode(""),k(w)?{[l]:w,then:I,otherwise:H}:w?I:H},n.$state=v,n.$store=function(w,{ident:I,backing:H,autosave:j}){let L,y;typeof H=="string"?H==="localstorage"&&(L=()=>localStorage.getItem(I),y=(N,U)=>{localStorage.setItem(N,U)}):{read:L,write:y}=H;let W=()=>{console.info("[dreamland.js]: saving "+I);let N={},U=0,V=re=>{let Q={stateful:S(re),values:{}},ce=U++;N[ce]=Q;for(let oe in re){let ue=re[oe];if(!k(ue))switch(typeof ue){case"string":case"number":case"boolean":case"undefined":Q.values[oe]=JSON.stringify(ue);break;case"object":if(ue instanceof Array){Q.values[oe]=ue.map(fe=>typeof fe=="object"?V(fe):JSON.stringify(fe));break}ue===null?Q.values[oe]="null":(ue.__proto__,Q.values[oe]=V(ue))}}return ce};V(w);let ne=JSON.stringify(N);y(I,ne)},q=(N,U,V)=>{S(V)&&(V[t][c]=q),W()},C=JSON.parse(L(I));if(C){let N={},U=V=>{if(N[V])return N[V];let ne=C[V],re={};for(let ce in ne.values){let oe=ne.values[ce];re[ce]=typeof oe=="string"?JSON.parse(oe):oe instanceof Array?oe.map(ue=>typeof ue=="string"?JSON.parse(ue):U(ue)):U(oe)}ne.stateful&&j=="auto"&&(re[c]=q);let Q=ne.stateful?v(re):re;return N[V]=Q,Q};w=U(0)}switch(j){case"beforeunload":addEventListener("beforeunload",W);break;case"manual":break;case"auto":w[c]=q}return v(w)},n.Fragment=x,n.css=$,n.h=J,n.html=function(w,...I){w=[...w];let H="",j={};for(let y=0;y<w.length;y++){let W=w[y],q=I[y],C=I[y]instanceof Function&&/^ *\/>/.exec(w[y+1]);if(/< *$/.test(W)&&C&&(w[y+1]=w[y+1].substr(C.index+C[0].length)),H+=W,y<I.length){let N,U=Object.values(j).findIndex(V=>V===q);U!==-1?N=Object.keys(j)[U]:(N="h"+O(),j[N]=q),H+=N,C&&(H+=`></${N}>`)}}let L=new DOMParser().parseFromString(H,"text/html");return L.body.children.length,function y(W){let q=W.nodeName.toLowerCase();if(q==="#text")return W.textContent;q in j&&(q=j[q]);let C=[...W.childNodes].map(y);for(let U=0;U<C.length;U++){let V=C[U];if(typeof V=="string")for(const[ne,re]of Object.entries(j)){if(!V)break;if(!V.includes(ne))continue;let Q;[Q,V]=V.split(ne),C=[...C.slice(0,U),Q,re,V,...C.slice(U+1)],U+=2}}let N={};if(!W.attributes)return W;for(const U of[...W.attributes]){let V=U.nodeValue;V in j&&(V=j[V]),N[U.name]=V}return J(q,N,C)}(L.body.children[0])},n.isDLPtr=k,n.isStateful=S,n.scope=b})(window);function ws_protocol(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,n=>(n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>n/4).toString(16))}function object_get(n,e){try{return n[e]}catch{return}}function object_set(n,e,t){try{n[e]=t}catch{}}async function convert_body_inner(n){let e=new Request("",{method:"POST",duplex:"half",body:n}),t=e.headers.get("content-type");return[new Uint8Array(await e.arrayBuffer()),t]}async function convert_streaming_body_inner(n){try{let e=new Request("",{method:"POST",body:n}),t=e.headers.get("content-type");return[!1,new Uint8Array(await e.arrayBuffer()),t]}catch{let t=new Request("",{method:"POST",duplex:"half",body:n}),r=t.headers.get("content-type");return[!0,t.body,r]}}function entries_of_object_inner(n){return Object.entries(n).map(e=>e.map(String))}function define_property(n,e,t){Object.defineProperty(n,e,{value:t,writable:!1})}function ws_key(){let n=new Uint8Array(16);return crypto.getRandomValues(n),btoa(String.fromCharCode.apply(null,n))}function from_entries(n){for(var e={},t=0;t<n.length;t++)e[n[t][0]]=n[t][1];return e}let wasm;const heap=new Array(128).fill(void 0);heap.push(void 0,null,!0,!1);function getObject(n){return heap[n]}let heap_next=heap.length;function addHeapObject(n){heap_next===heap.length&&heap.push(heap.length+1);const e=heap_next;return heap_next=heap[e],heap[e]=n,e}function isLikeNone(n){return n==null}function handleError(n,e){try{return n.apply(this,e)}catch(t){wasm.__wbindgen_exn_store(addHeapObject(t))}}function dropObject(n){n<132||(heap[n]=heap_next,heap_next=n)}function takeObject(n){const e=getObject(n);return dropObject(n),e}const cachedTextDecoder=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&cachedTextDecoder.decode();let cachedUint8ArrayMemory0=null;function getUint8ArrayMemory0(){return(cachedUint8ArrayMemory0===null||cachedUint8ArrayMemory0.byteLength===0)&&(cachedUint8ArrayMemory0=new Uint8Array(wasm.memory.buffer)),cachedUint8ArrayMemory0}function getStringFromWasm0(n,e){return n=n>>>0,cachedTextDecoder.decode(getUint8ArrayMemory0().subarray(n,n+e))}let cachedDataViewMemory0=null;function getDataViewMemory0(){return(cachedDataViewMemory0===null||cachedDataViewMemory0.buffer.detached===!0||cachedDataViewMemory0.buffer.detached===void 0&&cachedDataViewMemory0.buffer!==wasm.memory.buffer)&&(cachedDataViewMemory0=new DataView(wasm.memory.buffer)),cachedDataViewMemory0}let WASM_VECTOR_LEN=0;function passArrayJsValueToWasm0(n,e){const t=e(n.length*4,4)>>>0,r=getDataViewMemory0();for(let s=0;s<n.length;s++)r.setUint32(t+4*s,addHeapObject(n[s]),!0);return WASM_VECTOR_LEN=n.length,t}const cachedTextEncoder=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},encodeString=typeof cachedTextEncoder.encodeInto=="function"?function(n,e){return cachedTextEncoder.encodeInto(n,e)}:function(n,e){const t=cachedTextEncoder.encode(n);return e.set(t),{read:n.length,written:t.length}};function passStringToWasm0(n,e,t){if(t===void 0){const c=cachedTextEncoder.encode(n),_=e(c.length,1)>>>0;return getUint8ArrayMemory0().subarray(_,_+c.length).set(c),WASM_VECTOR_LEN=c.length,_}let r=n.length,s=e(r,1)>>>0;const a=getUint8ArrayMemory0();let l=0;for(;l<r;l++){const c=n.charCodeAt(l);if(c>127)break;a[s+l]=c}if(l!==r){l!==0&&(n=n.slice(l)),s=t(s,r,r=l+n.length*3,1)>>>0;const c=getUint8ArrayMemory0().subarray(s+l,s+r),_=encodeString(n,c);l+=_.written,s=t(s,r,l,1)>>>0}return WASM_VECTOR_LEN=l,s}function getArrayU8FromWasm0(n,e){return n=n>>>0,getUint8ArrayMemory0().subarray(n/1,n/1+e)}const CLOSURE_DTORS=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>{wasm.__wbindgen_export_3.get(n.dtor)(n.a,n.b)});function makeMutClosure(n,e,t,r){const s={a:n,b:e,cnt:1,dtor:t},a=(...l)=>{s.cnt++;const c=s.a;s.a=0;try{return r(c,s.b,...l)}finally{--s.cnt===0?(wasm.__wbindgen_export_3.get(s.dtor)(c,s.b),CLOSURE_DTORS.unregister(s)):s.a=c}};return a.original=s,CLOSURE_DTORS.register(a,s,s),a}function makeClosure(n,e,t,r){const s={a:n,b:e,cnt:1,dtor:t},a=(...l)=>{s.cnt++;try{return r(s.a,s.b,...l)}finally{--s.cnt===0&&(wasm.__wbindgen_export_3.get(s.dtor)(s.a,s.b),s.a=0,CLOSURE_DTORS.unregister(s))}};return a.original=s,CLOSURE_DTORS.register(a,s,s),a}function debugString(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const s=n.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){const s=n.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(n)){const s=n.length;let a="[";s>0&&(a+=debugString(n[0]));for(let l=1;l<s;l++)a+=", "+debugString(n[l]);return a+="]",a}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t&&t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function getArrayJsValueFromWasm0(n,e){n=n>>>0;const t=getDataViewMemory0(),r=[];for(let s=n;s<n+4*e;s+=4)r.push(takeObject(t.getUint32(s,!0)));return r}function _assertClass(n,e){if(!(n instanceof e))throw new Error(`expected instance of ${e.name}`)}function __wbg_adapter_32(n,e){wasm._dyn_core__ops__function__Fn_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hd3bdd319eab06bae(n,e)}function __wbg_adapter_35(n,e,t){wasm._dyn_core__ops__function__Fn__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hdbe711adc2cc07e4(n,e,addHeapObject(t))}function __wbg_adapter_40(n,e,t){wasm._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h37dcdaabe9b4189a(n,e,addHeapObject(t))}function __wbg_adapter_43(n,e){wasm._dyn_core__ops__function__FnMut_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h62ca192d761bcd0a(n,e)}function __wbg_adapter_169(n,e,t,r){wasm.wasm_bindgen__convert__closures__invoke2_mut__h87dcae41de9150ab(n,e,addHeapObject(t),addHeapObject(r))}const __wbindgen_enum_BinaryType=["blob","arraybuffer"],EpoxyClientFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_epoxyclient_free(n>>>0,1));class EpoxyClient{toJSON(){return{redirect_limit:this.redirect_limit,user_agent:this.user_agent,buffer_size:this.buffer_size}}toString(){return JSON.stringify(this)}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,EpoxyClientFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_epoxyclient_free(e,0)}get redirect_limit(){return wasm.__wbg_get_epoxyclient_redirect_limit(this.__wbg_ptr)>>>0}set redirect_limit(e){wasm.__wbg_set_epoxyclient_redirect_limit(this.__wbg_ptr,e)}get user_agent(){let e,t;try{const a=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbg_get_epoxyclient_user_agent(a,this.__wbg_ptr);var r=getDataViewMemory0().getInt32(a+4*0,!0),s=getDataViewMemory0().getInt32(a+4*1,!0);return e=r,t=s,getStringFromWasm0(r,s)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_free(e,t,1)}}set user_agent(e){const t=passStringToWasm0(e,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),r=WASM_VECTOR_LEN;wasm.__wbg_set_epoxyclient_user_agent(this.__wbg_ptr,t,r)}get buffer_size(){return wasm.__wbg_get_epoxyclient_buffer_size(this.__wbg_ptr)>>>0}set buffer_size(e){wasm.__wbg_set_epoxyclient_buffer_size(this.__wbg_ptr,e)}constructor(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);_assertClass(t,EpoxyClientOptions);var r=t.__destroy_into_raw();wasm.epoxyclient_new(c,addHeapObject(e),r);var s=getDataViewMemory0().getInt32(c+4*0,!0),a=getDataViewMemory0().getInt32(c+4*1,!0),l=getDataViewMemory0().getInt32(c+4*2,!0);if(l)throw takeObject(a);return this.__wbg_ptr=s>>>0,EpoxyClientFinalization.register(this,this.__wbg_ptr,this),this}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}replace_stream_provider(){const e=wasm.epoxyclient_replace_stream_provider(this.__wbg_ptr);return takeObject(e)}connect_websocket(e,t,r,s){_assertClass(e,EpoxyHandlers);var a=e.__destroy_into_raw();const l=passArrayJsValueToWasm0(r,wasm.__wbindgen_malloc),c=WASM_VECTOR_LEN,_=wasm.epoxyclient_connect_websocket(this.__wbg_ptr,a,addHeapObject(t),l,c,addHeapObject(s));return takeObject(_)}connect_tcp(e){const t=wasm.epoxyclient_connect_tcp(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}connect_tls(e){const t=wasm.epoxyclient_connect_tls(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}connect_udp(e){const t=wasm.epoxyclient_connect_udp(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}fetch(e,t){const r=wasm.epoxyclient_fetch(this.__wbg_ptr,addHeapObject(e),addHeapObject(t));return takeObject(r)}}const EpoxyClientOptionsFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_epoxyclientoptions_free(n>>>0,1));class EpoxyClientOptions{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,EpoxyClientOptionsFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_epoxyclientoptions_free(e,0)}get wisp_v2(){return wasm.__wbg_get_epoxyclientoptions_wisp_v2(this.__wbg_ptr)!==0}set wisp_v2(e){wasm.__wbg_set_epoxyclientoptions_wisp_v2(this.__wbg_ptr,e)}get udp_extension_required(){return wasm.__wbg_get_epoxyclientoptions_udp_extension_required(this.__wbg_ptr)!==0}set udp_extension_required(e){wasm.__wbg_set_epoxyclientoptions_udp_extension_required(this.__wbg_ptr,e)}get title_case_headers(){return wasm.__wbg_get_epoxyclientoptions_title_case_headers(this.__wbg_ptr)!==0}set title_case_headers(e){wasm.__wbg_set_epoxyclientoptions_title_case_headers(this.__wbg_ptr,e)}get ws_title_case_headers(){return wasm.__wbg_get_epoxyclientoptions_ws_title_case_headers(this.__wbg_ptr)!==0}set ws_title_case_headers(e){wasm.__wbg_set_epoxyclientoptions_ws_title_case_headers(this.__wbg_ptr,e)}get websocket_protocols(){try{const s=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbg_get_epoxyclientoptions_websocket_protocols(s,this.__wbg_ptr);var e=getDataViewMemory0().getInt32(s+4*0,!0),t=getDataViewMemory0().getInt32(s+4*1,!0),r=getArrayJsValueFromWasm0(e,t).slice();return wasm.__wbindgen_free(e,t*4,4),r}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}set websocket_protocols(e){const t=passArrayJsValueToWasm0(e,wasm.__wbindgen_malloc),r=WASM_VECTOR_LEN;wasm.__wbg_set_epoxyclientoptions_websocket_protocols(this.__wbg_ptr,t,r)}get redirect_limit(){return wasm.__wbg_get_epoxyclientoptions_redirect_limit(this.__wbg_ptr)>>>0}set redirect_limit(e){wasm.__wbg_set_epoxyclientoptions_redirect_limit(this.__wbg_ptr,e)}get header_limit(){return wasm.__wbg_get_epoxyclientoptions_header_limit(this.__wbg_ptr)>>>0}set header_limit(e){wasm.__wbg_set_epoxyclientoptions_header_limit(this.__wbg_ptr,e)}get user_agent(){let e,t;try{const a=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbg_get_epoxyclientoptions_user_agent(a,this.__wbg_ptr);var r=getDataViewMemory0().getInt32(a+4*0,!0),s=getDataViewMemory0().getInt32(a+4*1,!0);return e=r,t=s,getStringFromWasm0(r,s)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_free(e,t,1)}}set user_agent(e){const t=passStringToWasm0(e,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),r=WASM_VECTOR_LEN;wasm.__wbg_set_epoxyclientoptions_user_agent(this.__wbg_ptr,t,r)}get pem_files(){try{const s=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.__wbg_get_epoxyclientoptions_pem_files(s,this.__wbg_ptr);var e=getDataViewMemory0().getInt32(s+4*0,!0),t=getDataViewMemory0().getInt32(s+4*1,!0),r=getArrayJsValueFromWasm0(e,t).slice();return wasm.__wbindgen_free(e,t*4,4),r}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}set pem_files(e){const t=passArrayJsValueToWasm0(e,wasm.__wbindgen_malloc),r=WASM_VECTOR_LEN;wasm.__wbg_set_epoxyclientoptions_pem_files(this.__wbg_ptr,t,r)}get disable_certificate_validation(){return wasm.__wbg_get_epoxyclientoptions_disable_certificate_validation(this.__wbg_ptr)!==0}set disable_certificate_validation(e){wasm.__wbg_set_epoxyclientoptions_disable_certificate_validation(this.__wbg_ptr,e)}get buffer_size(){return wasm.__wbg_get_epoxyclientoptions_buffer_size(this.__wbg_ptr)>>>0}set buffer_size(e){wasm.__wbg_set_epoxyclientoptions_buffer_size(this.__wbg_ptr,e)}constructor(){const e=wasm.epoxyclientoptions_new_default();return this.__wbg_ptr=e>>>0,EpoxyClientOptionsFinalization.register(this,this.__wbg_ptr,this),this}}const EpoxyHandlersFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_epoxyhandlers_free(n>>>0,1));class EpoxyHandlers{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,EpoxyHandlersFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_epoxyhandlers_free(e,0)}get onopen(){const e=wasm.__wbg_get_epoxyhandlers_onopen(this.__wbg_ptr);return takeObject(e)}set onopen(e){wasm.__wbg_set_epoxyhandlers_onopen(this.__wbg_ptr,addHeapObject(e))}get onclose(){const e=wasm.__wbg_get_epoxyhandlers_onclose(this.__wbg_ptr);return takeObject(e)}set onclose(e){wasm.__wbg_set_epoxyhandlers_onclose(this.__wbg_ptr,addHeapObject(e))}get onerror(){const e=wasm.__wbg_get_epoxyhandlers_onerror(this.__wbg_ptr);return takeObject(e)}set onerror(e){wasm.__wbg_set_epoxyhandlers_onerror(this.__wbg_ptr,addHeapObject(e))}get onmessage(){const e=wasm.__wbg_get_epoxyhandlers_onmessage(this.__wbg_ptr);return takeObject(e)}set onmessage(e){wasm.__wbg_set_epoxyhandlers_onmessage(this.__wbg_ptr,addHeapObject(e))}constructor(e,t,r,s){const a=wasm.epoxyhandlers_new(addHeapObject(e),addHeapObject(t),addHeapObject(r),addHeapObject(s));return this.__wbg_ptr=a>>>0,EpoxyHandlersFinalization.register(this,this.__wbg_ptr,this),this}}const EpoxyWebSocketFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_epoxywebsocket_free(n>>>0,1));class EpoxyWebSocket{static __wrap(e){e=e>>>0;const t=Object.create(EpoxyWebSocket.prototype);return t.__wbg_ptr=e,EpoxyWebSocketFinalization.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,EpoxyWebSocketFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_epoxywebsocket_free(e,0)}send(e){const t=wasm.epoxywebsocket_send(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}close(e,t){const r=passStringToWasm0(t,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),s=WASM_VECTOR_LEN,a=wasm.epoxywebsocket_close(this.__wbg_ptr,e,r,s);return takeObject(a)}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(n=>wasm.__wbg_intounderlyingbytesource_free(n>>>0,1));const IntoUnderlyingSinkFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_intounderlyingsink_free(n>>>0,1));class IntoUnderlyingSink{static __wrap(e){e=e>>>0;const t=Object.create(IntoUnderlyingSink.prototype);return t.__wbg_ptr=e,IntoUnderlyingSinkFinalization.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,IntoUnderlyingSinkFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_intounderlyingsink_free(e,0)}write(e){const t=wasm.intounderlyingsink_write(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}close(){const e=this.__destroy_into_raw(),t=wasm.intounderlyingsink_close(e);return takeObject(t)}abort(e){const t=this.__destroy_into_raw(),r=wasm.intounderlyingsink_abort(t,addHeapObject(e));return takeObject(r)}}const IntoUnderlyingSourceFinalization=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>wasm.__wbg_intounderlyingsource_free(n>>>0,1));class IntoUnderlyingSource{static __wrap(e){e=e>>>0;const t=Object.create(IntoUnderlyingSource.prototype);return t.__wbg_ptr=e,IntoUnderlyingSourceFinalization.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,IntoUnderlyingSourceFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_intounderlyingsource_free(e,0)}pull(e){const t=wasm.intounderlyingsource_pull(this.__wbg_ptr,addHeapObject(e));return takeObject(t)}cancel(){const e=this.__destroy_into_raw();wasm.intounderlyingsource_cancel(e)}}async function __wbg_load(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function __wbg_get_imports(){const n={};return n.wbg={},n.wbg.__wbg_abort_2d215a4bf861d1a2=function(e){const t=getObject(e).abort();return addHeapObject(t)},n.wbg.__wbg_at_479807bfddde3a33=function(e,t){const r=getObject(e).at(t);return addHeapObject(r)},n.wbg.__wbg_buffer_61b7ce01341d7f88=function(e){const t=getObject(e).buffer;return addHeapObject(t)},n.wbg.__wbg_buffer_dc5dbfa8d5fb28cf=function(e){const t=getObject(e).buffer;return addHeapObject(t)},n.wbg.__wbg_byobRequest_1fc36a0c1e98611b=function(e){const t=getObject(e).byobRequest;return isLikeNone(t)?0:addHeapObject(t)},n.wbg.__wbg_byteLength_1b2d953758afc500=function(e){return getObject(e).byteLength},n.wbg.__wbg_byteOffset_7ef484c6c1d473e9=function(e){return getObject(e).byteOffset},n.wbg.__wbg_call_500db948e69c7330=function(){return handleError(function(e,t,r){const s=getObject(e).call(getObject(t),getObject(r));return addHeapObject(s)},arguments)},n.wbg.__wbg_call_b0d8e36992d9900d=function(){return handleError(function(e,t){const r=getObject(e).call(getObject(t));return addHeapObject(r)},arguments)},n.wbg.__wbg_cancel_ac971f285f1e9ab3=function(e){const t=getObject(e).cancel();return addHeapObject(t)},n.wbg.__wbg_catch_d0fc80129c999ab3=function(e,t){const r=getObject(e).catch(getObject(t));return addHeapObject(r)},n.wbg.__wbg_close_4063e1bcbd6d5fe2=function(){return handleError(function(e){getObject(e).close()},arguments)},n.wbg.__wbg_close_59511bda900d85a8=function(){return handleError(function(e){getObject(e).close()},arguments)},n.wbg.__wbg_close_65cb23eb0316f916=function(){return handleError(function(e){getObject(e).close()},arguments)},n.wbg.__wbg_convertbodyinner_567022e12dbe671d=function(){return handleError(function(e){const t=convert_body_inner(takeObject(e));return addHeapObject(t)},arguments)},n.wbg.__wbg_convertstreamingbodyinner_6e59b294ea57edab=function(){return handleError(function(e){const t=convert_streaming_body_inner(takeObject(e));return addHeapObject(t)},arguments)},n.wbg.__wbg_crypto_ed58b8e10a292839=function(e){const t=getObject(e).crypto;return addHeapObject(t)},n.wbg.__wbg_data_4ce8a82394d8b110=function(e){const t=getObject(e).data;return addHeapObject(t)},n.wbg.__wbg_defineproperty_191d90918b7f6248=function(e,t,r,s){define_property(getObject(e),getStringFromWasm0(t,r),takeObject(s))},n.wbg.__wbg_enqueue_3997a55771b5212a=function(){return handleError(function(e,t){getObject(e).enqueue(getObject(t))},arguments)},n.wbg.__wbg_entriesofobjectinner_ab1a59c8cab0f815=function(e,t){const r=entries_of_object_inner(getObject(t)),s=passArrayJsValueToWasm0(r,wasm.__wbindgen_malloc),a=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,a,!0),getDataViewMemory0().setInt32(e+4*0,s,!0)},n.wbg.__wbg_epoxywebsocket_new=function(e){const t=EpoxyWebSocket.__wrap(e);return addHeapObject(t)},n.wbg.__wbg_error_f4add1ed4f180dc2=function(e,t){console.error(getStringFromWasm0(e,t))},n.wbg.__wbg_from_d68eaa96dba25449=function(e){const t=Array.from(getObject(e));return addHeapObject(t)},n.wbg.__wbg_fromentries_752aac1fe771623d=function(){return handleError(function(e){const t=from_entries(getObject(e));return addHeapObject(t)},arguments)},n.wbg.__wbg_getRandomValues_bcb4912f16000dc4=function(){return handleError(function(e,t){getObject(e).getRandomValues(getObject(t))},arguments)},n.wbg.__wbg_getReader_48e00749fe3f6089=function(){return handleError(function(e){const t=getObject(e).getReader();return addHeapObject(t)},arguments)},n.wbg.__wbg_getWriter_dd1c7a1972bcd348=function(){return handleError(function(e){const t=getObject(e).getWriter();return addHeapObject(t)},arguments)},n.wbg.__wbg_get_9aa3dff3f0266054=function(e,t){const r=getObject(e)[t>>>0];return addHeapObject(r)},n.wbg.__wbg_get_bbccf8970793c087=function(){return handleError(function(e,t){const r=Reflect.get(getObject(e),getObject(t));return addHeapObject(r)},arguments)},n.wbg.__wbg_getdone_c9ef3af0d247e580=function(e){const t=getObject(e).done;return isLikeNone(t)?16777215:t?1:0},n.wbg.__wbg_getvalue_3597a1222fac0ae0=function(e){const t=getObject(e).value;return addHeapObject(t)},n.wbg.__wbg_href_e02c8426b1c9033d=function(e,t){const r=getObject(t).href,s=passStringToWasm0(r,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),a=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,a,!0),getDataViewMemory0().setInt32(e+4*0,s,!0)},n.wbg.__wbg_instanceof_ArrayBuffer_670ddde44cdb2602=function(e){let t;try{t=getObject(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_Error_2b29c5b4afac4e22=function(e){let t;try{t=getObject(e)instanceof Error}catch{t=!1}return t},n.wbg.__wbg_instanceof_Headers_a54ae4b841040dde=function(e){let t;try{t=getObject(e)instanceof Headers}catch{t=!1}return t},n.wbg.__wbg_instanceof_Promise_0aa3a90cfe6672c9=function(e){let t;try{t=getObject(e)instanceof Promise}catch{t=!1}return t},n.wbg.__wbg_instanceof_Url_e66a981eb3cc407a=function(e){let t;try{t=getObject(e)instanceof URL}catch{t=!1}return t},n.wbg.__wbg_length_65d1cd11729ced11=function(e){return getObject(e).length},n.wbg.__wbg_length_d65cf0786bfc5739=function(e){return getObject(e).length},n.wbg.__wbg_log_2f95d903e184aa9a=function(e,t){console.log(getStringFromWasm0(e,t))},n.wbg.__wbg_msCrypto_0a36e2ec3a343d26=function(e){const t=getObject(e).msCrypto;return addHeapObject(t)},n.wbg.__wbg_new_254fa9eac11932ae=function(){const e=new Array;return addHeapObject(e)},n.wbg.__wbg_new_3d446df9155128ef=function(e,t){try{var r={a:e,b:t},s=(l,c)=>{const _=r.a;r.a=0;try{return __wbg_adapter_169(_,r.b,l,c)}finally{r.a=_}};const a=new Promise(s);return addHeapObject(a)}finally{r.a=r.b=0}},n.wbg.__wbg_new_3ff5b33b1ce712df=function(e){const t=new Uint8Array(getObject(e));return addHeapObject(t)},n.wbg.__wbg_new_6799ef630abee97c=function(e,t){const r=new Error(getStringFromWasm0(e,t));return addHeapObject(r)},n.wbg.__wbg_new_688846f374351c92=function(){const e=new Object;return addHeapObject(e)},n.wbg.__wbg_new_9b6c38191d7b9512=function(){return handleError(function(e,t){const r=new WebSocket(getStringFromWasm0(e,t));return addHeapObject(r)},arguments)},n.wbg.__wbg_newnoargs_fd9e4bf8be2bc16d=function(e,t){const r=new Function(getStringFromWasm0(e,t));return addHeapObject(r)},n.wbg.__wbg_newwithbyteoffsetandlength_ba35896968751d91=function(e,t,r){const s=new Uint8Array(getObject(e),t>>>0,r>>>0);return addHeapObject(s)},n.wbg.__wbg_newwithintounderlyingsink_08f1a3e40fc70d83=function(e){const t=new WritableStream(IntoUnderlyingSink.__wrap(e));return addHeapObject(t)},n.wbg.__wbg_newwithintounderlyingsource_b47f6a6a596a7f24=function(e,t){const r=new ReadableStream(IntoUnderlyingSource.__wrap(e),takeObject(t));return addHeapObject(r)},n.wbg.__wbg_newwithlength_34ce8f1051e74449=function(e){const t=new Uint8Array(e>>>0);return addHeapObject(t)},n.wbg.__wbg_newwithoptreadablestreamandinit_79299cc49f3b9bdd=function(){return handleError(function(e,t){const r=new Response(getObject(e),getObject(t));return addHeapObject(r)},arguments)},n.wbg.__wbg_newwithstrsequence_5b5601fc2c0bff30=function(){return handleError(function(e,t,r){const s=new WebSocket(getStringFromWasm0(e,t),getObject(r));return addHeapObject(s)},arguments)},n.wbg.__wbg_node_02999533c4ea02e3=function(e){const t=getObject(e).node;return addHeapObject(t)},n.wbg.__wbg_now_62a101fe35b60230=function(e){return getObject(e).now()},n.wbg.__wbg_now_64d0bb151e5d3889=function(){return Date.now()},n.wbg.__wbg_now_71123b9940376874=function(e){return getObject(e).now()},n.wbg.__wbg_objectget_27e77920d8f6dba4=function(e,t,r){const s=object_get(getObject(e),getStringFromWasm0(t,r));return addHeapObject(s)},n.wbg.__wbg_objectset_aa9d510c6eb29bc3=function(e,t,r,s){object_set(getObject(e),getStringFromWasm0(t,r),takeObject(s))},n.wbg.__wbg_of_437cdae2760f8b94=function(e,t){const r=Array.of(getObject(e),getObject(t));return addHeapObject(r)},n.wbg.__wbg_performance_1a2515c93daf8b0c=function(e){const t=getObject(e).performance;return addHeapObject(t)},n.wbg.__wbg_process_5c1d670bc53614b8=function(e){const t=getObject(e).process;return addHeapObject(t)},n.wbg.__wbg_push_6edad0df4b546b2c=function(e,t){return getObject(e).push(getObject(t))},n.wbg.__wbg_queueMicrotask_2181040e064c0dc8=function(e){queueMicrotask(getObject(e))},n.wbg.__wbg_queueMicrotask_ef9ac43769cbcc4f=function(e){const t=getObject(e).queueMicrotask;return addHeapObject(t)},n.wbg.__wbg_randomFillSync_ab2cfe79ebbf2740=function(){return handleError(function(e,t){getObject(e).randomFillSync(takeObject(t))},arguments)},n.wbg.__wbg_read_4d173e86f707008c=function(e){const t=getObject(e).read();return addHeapObject(t)},n.wbg.__wbg_readyState_236b61903e1dbb47=function(e){return getObject(e).readyState},n.wbg.__wbg_releaseLock_2d9136d592a32095=function(e){getObject(e).releaseLock()},n.wbg.__wbg_require_79b1e9274cde3c87=function(){return handleError(function(){const e=module.require;return addHeapObject(e)},arguments)},n.wbg.__wbg_resolve_0bf7c44d641804f9=function(e){const t=Promise.resolve(getObject(e));return addHeapObject(t)},n.wbg.__wbg_respond_88fe7338392675f2=function(){return handleError(function(e,t){getObject(e).respond(t>>>0)},arguments)},n.wbg.__wbg_send_c2b76ede40fcced1=function(){return handleError(function(e,t,r){getObject(e).send(getArrayU8FromWasm0(t,r))},arguments)},n.wbg.__wbg_setTimeout_efd7c11531df1743=function(){return handleError(function(e,t,r){return getObject(e).setTimeout(getObject(t),r)},arguments)},n.wbg.__wbg_set_23d69db4e5c66a6e=function(e,t,r){getObject(e).set(getObject(t),r>>>0)},n.wbg.__wbg_setbinaryType_3fa4a9e8d2cc506f=function(e,t){getObject(e).binaryType=__wbindgen_enum_BinaryType[t]},n.wbg.__wbg_setheaders_9d4b8241e8063a9f=function(e,t){getObject(e).headers=getObject(t)},n.wbg.__wbg_sethighwatermark_af796d9564f89270=function(e,t){getObject(e).highWaterMark=t},n.wbg.__wbg_setonclose_f9c609d8c9938fa5=function(e,t){getObject(e).onclose=getObject(t)},n.wbg.__wbg_setonerror_8ae2b387470ec52e=function(e,t){getObject(e).onerror=getObject(t)},n.wbg.__wbg_setonmessage_5e7ade2af360de9d=function(e,t){getObject(e).onmessage=getObject(t)},n.wbg.__wbg_setonopen_54faa9e83483da1d=function(e,t){getObject(e).onopen=getObject(t)},n.wbg.__wbg_setstatus_9b90889d616b0586=function(e,t){getObject(e).status=t},n.wbg.__wbg_setstatustext_414bdc4b61159b75=function(e,t,r){getObject(e).statusText=getStringFromWasm0(t,r)},n.wbg.__wbg_static_accessor_GLOBAL_0be7472e492ad3e3=function(){const e=typeof global>"u"?null:global;return isLikeNone(e)?0:addHeapObject(e)},n.wbg.__wbg_static_accessor_GLOBAL_THIS_1a6eb482d12c9bfb=function(){const e=typeof globalThis>"u"?null:globalThis;return isLikeNone(e)?0:addHeapObject(e)},n.wbg.__wbg_static_accessor_SELF_1dc398a895c82351=function(){const e=typeof self>"u"?null:self;return isLikeNone(e)?0:addHeapObject(e)},n.wbg.__wbg_static_accessor_WINDOW_ae1c80c7eea8d64a=function(){const e=typeof window>"u"?null:window;return isLikeNone(e)?0:addHeapObject(e)},n.wbg.__wbg_subarray_46adeb9b86949d12=function(e,t,r){const s=getObject(e).subarray(t>>>0,r>>>0);return addHeapObject(s)},n.wbg.__wbg_tee_15d2d039bef462ae=function(){return handleError(function(e){const t=getObject(e).tee();return addHeapObject(t)},arguments)},n.wbg.__wbg_then_0438fad860fe38e1=function(e,t){const r=getObject(e).then(getObject(t));return addHeapObject(r)},n.wbg.__wbg_then_0ffafeddf0e182a4=function(e,t,r){const s=getObject(e).then(getObject(t),getObject(r));return addHeapObject(s)},n.wbg.__wbg_toString_cbcf95f260c441ae=function(e){const t=getObject(e).toString();return addHeapObject(t)},n.wbg.__wbg_versions_c71aa1626a93e0a1=function(e){const t=getObject(e).versions;return addHeapObject(t)},n.wbg.__wbg_view_a03cbb1d55c73e57=function(e){const t=getObject(e).view;return isLikeNone(t)?0:addHeapObject(t)},n.wbg.__wbg_write_0aea81ae26043440=function(e,t){const r=getObject(e).write(getObject(t));return addHeapObject(r)},n.wbg.__wbg_wskey_c8415c057e84eaff=function(e){const t=ws_key(),r=passStringToWasm0(t,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),s=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,s,!0),getDataViewMemory0().setInt32(e+4*0,r,!0)},n.wbg.__wbg_wsprotocol_b497ba0bd4aa0a6e=function(e){const t=ws_protocol(),r=passStringToWasm0(t,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),s=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,s,!0),getDataViewMemory0().setInt32(e+4*0,r,!0)},n.wbg.__wbindgen_cb_drop=function(e){const t=takeObject(e).original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbindgen_closure_wrapper1458=function(e,t,r){const s=makeMutClosure(e,t,212,__wbg_adapter_40);return addHeapObject(s)},n.wbg.__wbindgen_closure_wrapper4222=function(e,t,r){const s=makeMutClosure(e,t,212,__wbg_adapter_43);return addHeapObject(s)},n.wbg.__wbindgen_closure_wrapper477=function(e,t,r){const s=makeClosure(e,t,19,__wbg_adapter_32);return addHeapObject(s)},n.wbg.__wbindgen_closure_wrapper479=function(e,t,r){const s=makeClosure(e,t,19,__wbg_adapter_35);return addHeapObject(s)},n.wbg.__wbindgen_closure_wrapper481=function(e,t,r){const s=makeClosure(e,t,19,__wbg_adapter_35);return addHeapObject(s)},n.wbg.__wbindgen_debug_string=function(e,t){const r=debugString(getObject(t)),s=passStringToWasm0(r,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),a=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,a,!0),getDataViewMemory0().setInt32(e+4*0,s,!0)},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(getStringFromWasm0(e,t));return addHeapObject(r)},n.wbg.__wbindgen_is_array=function(e){return Array.isArray(getObject(e))},n.wbg.__wbindgen_is_falsy=function(e){return!getObject(e)},n.wbg.__wbindgen_is_function=function(e){return typeof getObject(e)=="function"},n.wbg.__wbindgen_is_object=function(e){const t=getObject(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_string=function(e){return typeof getObject(e)=="string"},n.wbg.__wbindgen_is_undefined=function(e){return getObject(e)===void 0},n.wbg.__wbindgen_memory=function(){const e=wasm.memory;return addHeapObject(e)},n.wbg.__wbindgen_object_clone_ref=function(e){const t=getObject(e);return addHeapObject(t)},n.wbg.__wbindgen_object_drop_ref=function(e){takeObject(e)},n.wbg.__wbindgen_string_get=function(e,t){const r=getObject(t),s=typeof r=="string"?r:void 0;var a=isLikeNone(s)?0:passStringToWasm0(s,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),l=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4*1,l,!0),getDataViewMemory0().setInt32(e+4*0,a,!0)},n.wbg.__wbindgen_string_new=function(e,t){const r=getStringFromWasm0(e,t);return addHeapObject(r)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(getStringFromWasm0(e,t))},n}function __wbg_finalize_init(n,e){return wasm=n.exports,__wbg_init.__wbindgen_wasm_module=e,cachedDataViewMemory0=null,cachedUint8ArrayMemory0=null,wasm}async function __wbg_init(n){if(wasm!==void 0)return;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL(""+new URL("epoxy.wasm",import.meta.url).href,import.meta.url));const e=__wbg_get_imports();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await __wbg_load(await n,e);__wbg_finalize_init(t,r)}const info={version:"2.1.17-1",release:!0,commit:"2e8ac98d79f687b0f26f799207cae1824f5edcbb"},EPOXY_PATH=""+new URL("epoxy.wasm",import.meta.url).href;let store=$store({theme:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark",wisp:"wss://anura.pro/",epoxyVersion:""},{ident:"options",backing:"localstorage",autosave:"auto"}),epoxyVersion=info.version+info.commit+info.release,cache=await window.caches.open("epoxy"),initted=!1,currentClient,currentWispUrl;async function evict(){await cache.delete(EPOXY_PATH)}async function instantiate(){await cache.match(EPOXY_PATH)||await cache.add(EPOXY_PATH);const n=await cache.match(EPOXY_PATH);await __wbg_init({module_or_path:n}),initted=!0}async function tryInit(){initted||(epoxyVersion===store.epoxyVersion?await instantiate():(await evict(),await instantiate(),console.log(`evicted epoxy "${store.epoxyVersion}" from cache because epoxy "${epoxyVersion}" is available`),store.epoxyVersion=epoxyVersion)),currentWispUrl!==store.wisp&&await createEpoxy()}function getWispUrl(){return currentWispUrl}async function createEpoxy(){let n=new EpoxyClientOptions;n.user_agent=navigator.userAgent+" Terraria/WASM TerrariaWasm/"+location.hostname,n.udp_extension_required=!1,currentWispUrl=store.wisp,currentClient=new EpoxyClient(currentWispUrl,n)}async function epoxyFetch(n,e){await tryInit();try{return await currentClient.fetch(n,e)}catch(t){let r=t;throw console.log(r),r}}const WebSocketFields={CLOSED:WebSocket.CLOSED,CLOSING:WebSocket.CLOSING,CONNECTING:WebSocket.CONNECTING,OPEN:WebSocket.OPEN};class EpxTcpWs extends EventTarget{url;readyState=WebSocketFields.CONNECTING;ws;binaryType="blob";bufferedAmount=0;onopen;onclose;onmessage;onerror;realOnClose;constructor(e,t){super(),this.url=e.toString();const r=()=>{this.readyState=WebSocketFields.OPEN;const c=new Event("open");this.dispatchEvent(c),this.onopen&&this.onopen(c)},s=async c=>{let _;this.binaryType==="blob"?_=new Blob([c]):this.binaryType==="arraybuffer"&&(_=c.buffer);const p=new MessageEvent("message",{data:_});this.dispatchEvent(p),this.onmessage&&this.onmessage(p)},a=(c,_)=>{this.readyState=WebSocketFields.CLOSED;const p=new CloseEvent("close",{code:c,reason:_});this.dispatchEvent(p),this.onclose&&this.onclose(p)};this.realOnClose=a;const l=()=>{this.readyState=WebSocketFields.CLOSED;const c=new Event("error");this.dispatchEvent(c),this.onerror&&this.onerror(c)};if(!["tcp","udp","tls"].includes(t))throw"invalid";(async()=>{await tryInit();let c=null;try{t==="tcp"?c=await currentClient.connect_tcp(e):t==="udp"?c=await currentClient.connect_udp(e):t==="tls"&&(c=await currentClient.connect_tls(e))}catch(O){console.error("tcpws connect error",O),l();return}this.ws=c.write.getWriter();const _=c.read.getReader();this.readyState=WebSocketFields.OPEN,r();let p=!1;for(;;)try{const{value:O,done:D}=await _.read();if(D||!O)break;s(O)}catch(O){l(),console.error(O),p=!0;break}this.readyState=WebSocketFields.CLOSED,a(p?1011:1e3,p?"epoxy.ts errored":"normal")})()}send(...e){if(this.readyState===WebSocketFields.CONNECTING||!this.ws)throw new DOMException("Failed to execute 'send' on 'WebSocket': Still in CONNECTING state.");let t=e[0];t.buffer&&(t=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)),this.bufferedAmount++,this.ws.write(t).then(()=>{this.bufferedAmount--})}close(e,t){this.readyState===WebSocketFields.OPEN&&(this.readyState=WebSocketFields.CLOSING,this.ws?.close().then(r=>console.log("really closed",r)),this.readyState=WebSocketFields.CLOSED,this.realOnClose(1e3,"normal"))}}self.epoxyFetch=epoxyFetch;const gameState=$state({qr:null,ready:!1,loginstate:0,playing:!1,logbuf:[]}),dotnet=(await eval('import("/_framework/dotnet.js")')).dotnet;let exports;function encryptRSA(n,e,t){const r=(_,p,O)=>{let D=1n;for(_=_%O;p>0n;)p%2n===1n&&(D=D*_%O),p=p>>1n,_=_*_%O;return D},a=((_,p)=>{const O=_.length,D=Math.ceil(p.toString(16).length/2);if(O>D-11)throw new Error("Message too long for RSA encryption");const $=D-O-3,b=Array($).fill(255);return BigInt("0x"+["00","02",...b.map(P=>P.toString(16).padStart(2,"0")),"00",...Array.from(_).map(P=>P.toString(16).padStart(2,"0"))].join(""))})(n,e);let c=r(a,t,e).toString(16);return c.length%2&&(c="0"+c),new Uint8Array(Array.from(c.match(/.{2}/g)||[]).map(_=>parseInt(_,16)))}const realFetch=window.fetch;async function preInit(){console.debug("initializing dotnet");const n=await dotnet.withConfig({pthreadPoolInitialSize:16}).withEnvironmentVariable("MONO_SLEEP_ABORT_LIMIT","99999").withRuntimeOptions(["--jiterpreter-minimum-trace-hit-count=500","--jiterpreter-trace-monitoring-period=100","--jiterpreter-trace-monitoring-max-average-penalty=150",`--jiterpreter-wasm-bytes-limit=${64*1024*1024}`,`--jiterpreter-table-size=${32*1024}`,"--jiterpreter-stats-enabled"]).withResourceLoader((t,r,s,a,l)=>{if(t==="dotnetwasm"&&l==="dotnetwasm")return(async()=>{let c=0,_=async()=>{let b=await realFetch(s+c);if(c++,!b.body)throw new Error("no body in fetch response");return b.status===200&&!b.headers.get("content-type")?b.body.getReader():null},p=await _();if(!p)throw new Error("failed to fetch first chunk");let O=p,D=new ReadableStream({async pull(b){let{value:P,done:B}=await O.read();B||!P?(p=await _(),p?(O=p,await this.pull(b)):b.close()):b.enqueue(P)}});return new Response(D,{headers:new Headers({"Content-Type":"application/wasm"})})})()}).create();console.log("loading epoxy"),window.WebSocket=new Proxy(WebSocket,{construct(t,r,s){const a=new URL(r[0]);return r[0]===getWispUrl()||a.host===location.host?Reflect.construct(t,r,s):a.hostname.startsWith("__terraria_wisp_proxy_ws__")?new EpxTcpWs(a.pathname.substring(1),a.hostname.replace("__terraria_wisp_proxy_ws__","")):new EpxWs(...r)}}),window.fetch=epoxyFetch;const e=n.getConfig();exports=await n.getAssemblyExports(e.mainAssemblyName),window.exports=exports,n.setModuleImports("interop.js",{encryptrsa:(t,r,s)=>{let a=BigInt("0x"+t),l=BigInt("0x"+r),c=encryptRSA(s,a,l);return new Uint8Array(c)}}),n.setModuleImports("depot.js",{newqr:t=>{gameState.qr=t}}),self.wasm={Module:n.Module,dotnet,runtime:n,config:e,exports},console.debug("PreInit..."),await n.runMain(),await exports.Program.PreInit(),console.debug("dotnet initialized"),gameState.ready=!0}async function initSteam(n,e,t){return await exports.Steam.Init(n,e,t)}async function downloadApp(){return await exports.Steam.DownloadApp()}async function play(){gameState.playing=!0,console.debug("Init...");const n=performance.now();await exports.Program.Init(screen.width,screen.height);const e=performance.now();console.debug(`Init : ${(e-n).toFixed(2)}ms`),console.debug("MainLoop..."),await exports.Program.MainLoop(),console.debug("Cleanup..."),await exports.Program.Cleanup(),gameState.ready=!1,gameState.playing=!1}useChange([gameState.playing],()=>{try{gameState.playing?navigator.keyboard.lock():navigator.keyboard.unlock()}catch(n){console.log("keyboard lock error:",n)}});document.addEventListener("keydown",n=>{gameState.playing&&["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab"].includes(n.code)&&n.preventDefault()});function proxyConsole(n,e){const t=console[n].bind(console);console[n]=(...r)=>{let s;try{s=r.join(" ")}catch{s="<failed to render>"}t(...r),gameState.logbuf=[{color:e,log:`[${new Date().toISOString()}]: ${s}`}]}}proxyConsole("error","var(--error)");proxyConsole("warn","var(--warning)");proxyConsole("log","var(--fg)");proxyConsole("info","var(--info)");proxyConsole("debug","var(--fg6)");const LogView=function(){this.css=`
		height: 16rem;
		overflow: scroll;
		padding: 1em;
		background: var(--bg);

		font-family: var(--font-mono);

		::-webkit-scrollbar {
			display: none;
		}
	`;const n=(e,t)=>{const r=document.createElement("div");return r.innerText=t,r.style.color=e,r};return this.mount=()=>{useChange([gameState.logbuf],()=>{if(gameState.logbuf.length>0){for(const e of gameState.logbuf)this.root.appendChild(n(e.color,e.log));this.root.scrollTop=this.root.scrollHeight}})},h("div",{class:"tcontainer"})},Icon=function(){return this._leak=!0,this.mount=()=>{this.root.innerHTML=this.icon.body,useChange([this.icon],()=>{this.root.innerHTML=this.icon.body})},h("svg",{width:"1em",height:"1em",viewBox:use`0 0 ${this.icon.width} ${this.icon.height}`,xmlns:"http://www.w3.org/2000/svg",class:`component-icon ${this.class}`})},Button=function(){return this._leak=!0,this.css=`
		button {
			display: flex;
			align-items: center;
			justify-content: center;

			width: 100%;
			height: 100%;

			padding: 0.5rem;

			transition: background 0.25s;
			font-family: var(--font-body);
			cursor: pointer;
			font-size: 13pt;
		}

		button.icon-full svg, button.icon-left svg {
			width: 1.5rem;
			height: 1.5rem;
		}
		button.icon-full {
		}
		button.icon-left {
			gap: 0.25rem;
		}

		button.type-primary {
			background: var(--bg);
			color: var(--fg);
		}
		button.type-normal {
			background: var(--bg);
			color: var(--fg);
		}
		button.type-listitem {
			background: transparent;
			color: var(--fg);
			border-radius: 0.5rem;
		}
		button.type-listaction {
			background: var(--bg);
			color: var(--fg);
		}

		button.type-primary:not(:disabled):hover {
			background: color-mix(in srgb, var(--bg) 95%, white);
		}
		button.type-primary:not(:disabled):active {
			background: color-mix(in srgb, var(--bg) 95%, white);
		}
		button.type-normal:not(:disabled):hover {
			background: var(--surface2);
		}
		button.type-normal:not(:disabled):active {
			background: var(--surface3);
		}
		button.type-listitem:not(:disabled):hover {
			background: var(--surface1);
		}
		button.type-listitem:not(:disabled):active {
			background: var(--surface2);
		}
		button.type-listaction:not(:disabled):hover {
			background: var(--surface3);
		}
		button.type-listaction:not(:disabled):active {
			background: var(--surface4);
		}

		button:disabled {
			background: var(--surface0);
			cursor: not-allowed;
		}
	`,h("div",null,h("button",{"on:click":this["on:click"],class:`tcontainer icon-${this.icon} type-${this.type} ${this.class}`,disabled:use(this.disabled),title:use(this.title),"aria-label":this.label},use(this.children)))},Link=function(){return h("a",{href:this.href,class:"component-link",target:"_blank"},this.children)};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var tarStream={},events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(m,S,F){return Function.prototype.apply.call(m,S,F)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:t=function(m){return Object.getOwnPropertyNames(m)};function r(v){console&&console.warn&&console.warn(v)}var s=Number.isNaN||function(m){return m!==m};function a(){a.init.call(this)}events.exports=a,events.exports.once=z,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");l=v}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||s(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function _(v){return v._maxListeners===void 0?a.defaultMaxListeners:v._maxListeners}a.prototype.getMaxListeners=function(){return _(this)},a.prototype.emit=function(m){for(var S=[],F=1;F<arguments.length;F++)S.push(arguments[F]);var k=m==="error",g=this._events;if(g!==void 0)k=k&&g.error===void 0;else if(!k)return!1;if(k){var u;if(S.length>0&&(u=S[0]),u instanceof Error)throw u;var T=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw T.context=u,T}var M=g[m];if(M===void 0)return!1;if(typeof M=="function")e(M,this,S);else for(var J=M.length,te=P(M,J),F=0;F<J;++F)e(te[F],this,S);return!0};function p(v,m,S,F){var k,g,u;if(c(S),g=v._events,g===void 0?(g=v._events=Object.create(null),v._eventsCount=0):(g.newListener!==void 0&&(v.emit("newListener",m,S.listener?S.listener:S),g=v._events),u=g[m]),u===void 0)u=g[m]=S,++v._eventsCount;else if(typeof u=="function"?u=g[m]=F?[S,u]:[u,S]:F?u.unshift(S):u.push(S),k=_(v),k>0&&u.length>k&&!u.warned){u.warned=!0;var T=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");T.name="MaxListenersExceededWarning",T.emitter=v,T.type=m,T.count=u.length,r(T)}return v}a.prototype.addListener=function(m,S){return p(this,m,S,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(m,S){return p(this,m,S,!0)};function O(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(v,m,S){var F={fired:!1,wrapFn:void 0,target:v,type:m,listener:S},k=O.bind(F);return k.listener=S,F.wrapFn=k,k}a.prototype.once=function(m,S){return c(S),this.on(m,D(this,m,S)),this},a.prototype.prependOnceListener=function(m,S){return c(S),this.prependListener(m,D(this,m,S)),this},a.prototype.removeListener=function(m,S){var F,k,g,u,T;if(c(S),k=this._events,k===void 0)return this;if(F=k[m],F===void 0)return this;if(F===S||F.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete k[m],k.removeListener&&this.emit("removeListener",m,F.listener||S));else if(typeof F!="function"){for(g=-1,u=F.length-1;u>=0;u--)if(F[u]===S||F[u].listener===S){T=F[u].listener,g=u;break}if(g<0)return this;g===0?F.shift():B(F,g),F.length===1&&(k[m]=F[0]),k.removeListener!==void 0&&this.emit("removeListener",m,T||S)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(m){var S,F,k;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete F[m]),this;if(arguments.length===0){var g=Object.keys(F),u;for(k=0;k<g.length;++k)u=g[k],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=F[m],typeof S=="function")this.removeListener(m,S);else if(S!==void 0)for(k=S.length-1;k>=0;k--)this.removeListener(m,S[k]);return this};function $(v,m,S){var F=v._events;if(F===void 0)return[];var k=F[m];return k===void 0?[]:typeof k=="function"?S?[k.listener||k]:[k]:S?x(k):P(k,k.length)}a.prototype.listeners=function(m){return $(this,m,!0)},a.prototype.rawListeners=function(m){return $(this,m,!1)},a.listenerCount=function(v,m){return typeof v.listenerCount=="function"?v.listenerCount(m):b.call(v,m)},a.prototype.listenerCount=b;function b(v){var m=this._events;if(m!==void 0){var S=m[v];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function P(v,m){for(var S=new Array(m),F=0;F<m;++F)S[F]=v[F];return S}function B(v,m){for(;m+1<v.length;m++)v[m]=v[m+1];v.pop()}function x(v){for(var m=new Array(v.length),S=0;S<m.length;++S)m[S]=v[S].listener||v[S];return m}function z(v,m){return new Promise(function(S,F){function k(u){v.removeListener(m,g),F(u)}function g(){typeof v.removeListener=="function"&&v.removeListener("error",k),S([].slice.call(arguments))}se(v,m,g,{once:!0}),m!=="error"&&K(v,k,{once:!0})})}function K(v,m,S){typeof v.on=="function"&&se(v,"error",m,S)}function se(v,m,S,F){if(typeof v.on=="function")F.once?v.once(m,S):v.on(m,S);else if(typeof v.addEventListener=="function")v.addEventListener(m,function k(g){F.once&&v.removeEventListener(m,k),S(g)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v)}return events.exports}var fixedSize,hasRequiredFixedSize;function requireFixedSize(){return hasRequiredFixedSize||(hasRequiredFixedSize=1,fixedSize=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}),fixedSize}var fastFifo,hasRequiredFastFifo;function requireFastFifo(){if(hasRequiredFastFifo)return fastFifo;hasRequiredFastFifo=1;const n=requireFixedSize();return fastFifo=class{constructor(t){this.hwm=t||16,this.head=new n(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(t){if(this.length++,!this.head.push(t)){const r=this.head;this.head=r.next=new n(2*this.head.buffer.length),this.head.push(t)}}shift(){this.length!==0&&this.length--;const t=this.tail.shift();if(t===void 0&&this.tail.next){const r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return t}peek(){const t=this.tail.peek();return t===void 0&&this.tail.next?this.tail.next.peek():t}isEmpty(){return this.length===0}},fastFifo}var browserDecoder,hasRequiredBrowserDecoder;function requireBrowserDecoder(){return hasRequiredBrowserDecoder||(hasRequiredBrowserDecoder=1,browserDecoder=class{constructor(e){this.decoder=new TextDecoder(e==="utf16le"?"utf16-le":e)}get remaining(){return-1}decode(e){return this.decoder.decode(e,{stream:!0})}flush(){return this.decoder.decode(new Uint8Array(0))}}),browserDecoder}var textDecoder,hasRequiredTextDecoder;function requireTextDecoder(){if(hasRequiredTextDecoder)return textDecoder;hasRequiredTextDecoder=1;const n=requireBrowserDecoder(),e=requireBrowserDecoder();textDecoder=class{constructor(s="utf8"){switch(this.encoding=t(s),this.encoding){case"utf8":this.decoder=new e;break;case"utf16le":case"base64":throw new Error("Unsupported encoding: "+this.encoding);default:this.decoder=new n(this.encoding)}}get remaining(){return this.decoder.remaining}push(s){return typeof s=="string"?s:this.decoder.decode(s)}write(s){return this.push(s)}end(s){let a="";return s&&(a=this.push(s)),a+=this.decoder.flush(),a}};function t(r){switch(r=r.toLowerCase(),r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:throw new Error("Unknown encoding: "+r)}}return textDecoder}var streamx,hasRequiredStreamx;function requireStreamx(){if(hasRequiredStreamx)return streamx;hasRequiredStreamx=1;const{EventEmitter:n}=requireEvents(),e=new Error("Stream was destroyed"),t=new Error("Premature close"),r=requireFastFifo(),s=requireTextDecoder(),a=(1<<29)-1,l=1,c=2,_=4,p=8,O=a^l,D=a^c,$=16,b=32,P=64,B=128,x=256,z=512,K=1024,se=2048,v=4096,m=8192,S=16384,F=32768,k=65536,g=131072,u=x|z,T=$|k,M=P|$,J=v|B,te=x|g,de=a^$,w=a^P,I=a^(P|k),H=a^k,j=a^x,L=a^(B|m),y=a^K,W=a^u,q=a^F,C=a^b,N=a^g,U=a^te,V=1<<18,ne=2<<18,re=4<<18,Q=8<<18,ce=16<<18,oe=32<<18,ue=64<<18,fe=128<<18,me=256<<18,o=512<<18,d=1024<<18,f=a^(V|me),A=a^re,G=a^(V|o),Z=a^ce,le=a^Q,be=a^fe,Be=a^ne,Re=a^d,ye=$|V,je=a^ye,ke=S|oe,_e=_|p|c,he=_e|l,Ie=_e|ke,Ge=A&w,Ee=fe|F,Ye=Ee&je,De=he|Ye,Ke=he|K|S,Fe=he|S|B,Je=he|K|B,Qe=he|v|B|m,Xe=he|$|K|S|k|g,Ze=_e|K|S,et=b|he|F|P,tt=F|l,nt=he|o|oe,rt=Q|ce,Ce=Q|V,it=Q|ce|he|V,Ne=he|V|Q|d,st=re|V,at=V|me,ot=he|o|Ce|oe,ct=ce|_e|o|oe,lt=ne|he|fe|re,ut=o|oe|_e,Oe=Symbol.asyncIterator||Symbol("asyncIterator");class We{constructor(i,{highWaterMark:E=16384,map:Y=null,mapWritable:X,byteLength:ae,byteLengthWritable:ie}={}){this.stream=i,this.queue=new r,this.highWaterMark=E,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=ie||ae||Ve,this.map=X||Y,this.afterWrite=gt.bind(this),this.afterUpdateNextTick=mt.bind(this)}get ended(){return(this.stream._duplexState&oe)!==0}push(i){return(this.stream._duplexState&ut)!==0?!1:(this.map!==null&&(i=this.map(i)),this.buffered+=this.byteLength(i),this.queue.push(i),this.buffered<this.highWaterMark?(this.stream._duplexState|=Q,!0):(this.stream._duplexState|=rt,!1))}shift(){const i=this.queue.shift();return this.buffered-=this.byteLength(i),this.buffered===0&&(this.stream._duplexState&=le),i}end(i){typeof i=="function"?this.stream.once("finish",i):i!=null&&this.push(i),this.stream._duplexState=(this.stream._duplexState|o)&A}autoBatch(i,E){const Y=[],X=this.stream;for(Y.push(i);(X._duplexState&Ne)===Ce;)Y.push(X._writableState.shift());if((X._duplexState&he)!==0)return E(null);X._writev(Y,E)}update(){const i=this.stream;i._duplexState|=ne;do{for(;(i._duplexState&Ne)===Q;){const E=this.shift();i._duplexState|=at,i._write(E,this.afterWrite)}(i._duplexState&st)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);i._duplexState&=Be}updateNonPrimary(){const i=this.stream;if((i._duplexState&ot)===o){i._duplexState=i._duplexState|V,i._final(pt.bind(this));return}if((i._duplexState&_e)===_){(i._duplexState&Ee)===0&&(i._duplexState|=ye,i._destroy(Pe.bind(this)));return}(i._duplexState&De)===l&&(i._duplexState=(i._duplexState|ye)&O,i._open(qe.bind(this)))}continueUpdate(){return(this.stream._duplexState&fe)===0?!1:(this.stream._duplexState&=be,!0)}updateCallback(){(this.stream._duplexState&lt)===re?this.update():this.updateNextTick()}updateNextTick(){(this.stream._duplexState&fe)===0&&(this.stream._duplexState|=fe,(this.stream._duplexState&ne)===0&&queueMicrotask(this.afterUpdateNextTick))}}class dt{constructor(i,{highWaterMark:E=16384,map:Y=null,mapReadable:X,byteLength:ae,byteLengthReadable:ie}={}){this.stream=i,this.queue=new r,this.highWaterMark=E===0?1:E,this.buffered=0,this.readAhead=E>0,this.error=null,this.pipeline=null,this.byteLength=ie||ae||Ve,this.map=X||Y,this.pipeTo=null,this.afterRead=bt.bind(this),this.afterUpdateNextTick=wt.bind(this)}get ended(){return(this.stream._duplexState&S)!==0}pipe(i,E){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof E!="function"&&(E=null),this.stream._duplexState|=z,this.pipeTo=i,this.pipeline=new ft(this.stream,i,E),E&&this.stream.on("error",$e),Se(i))i._writableState.pipeline=this.pipeline,E&&i.on("error",$e),i.on("finish",this.pipeline.finished.bind(this.pipeline));else{const Y=this.pipeline.done.bind(this.pipeline,i),X=this.pipeline.done.bind(this.pipeline,i,null);i.on("error",Y),i.on("close",X),i.on("finish",this.pipeline.finished.bind(this.pipeline))}i.on("drain",_t.bind(this)),this.stream.emit("piping",i),i.emit("pipe",this.stream)}push(i){const E=this.stream;return i===null?(this.highWaterMark=0,E._duplexState=(E._duplexState|K)&I,!1):this.map!==null&&(i=this.map(i),i===null)?(E._duplexState&=H,this.buffered<this.highWaterMark):(this.buffered+=this.byteLength(i),this.queue.push(i),E._duplexState=(E._duplexState|B)&H,this.buffered<this.highWaterMark)}shift(){const i=this.queue.shift();return this.buffered-=this.byteLength(i),this.buffered===0&&(this.stream._duplexState&=L),i}unshift(i){const E=[this.map!==null?this.map(i):i];for(;this.buffered>0;)E.push(this.shift());for(let Y=0;Y<E.length-1;Y++){const X=E[Y];this.buffered+=this.byteLength(X),this.queue.push(X)}this.push(E[E.length-1])}read(){const i=this.stream;if((i._duplexState&Fe)===B){const E=this.shift();return this.pipeTo!==null&&this.pipeTo.write(E)===!1&&(i._duplexState&=W),(i._duplexState&se)!==0&&i.emit("data",E),E}return this.readAhead===!1&&(i._duplexState|=g,this.updateNextTick()),null}drain(){const i=this.stream;for(;(i._duplexState&Fe)===B&&(i._duplexState&u)!==0;){const E=this.shift();this.pipeTo!==null&&this.pipeTo.write(E)===!1&&(i._duplexState&=W),(i._duplexState&se)!==0&&i.emit("data",E)}}update(){const i=this.stream;i._duplexState|=b;do{for(this.drain();this.buffered<this.highWaterMark&&(i._duplexState&Xe)===g;)i._duplexState|=T,i._read(this.afterRead),this.drain();(i._duplexState&Qe)===J&&(i._duplexState|=m,i.emit("readable")),(i._duplexState&M)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);i._duplexState&=C}updateNonPrimary(){const i=this.stream;if((i._duplexState&Je)===K&&(i._duplexState=(i._duplexState|S)&y,i.emit("end"),(i._duplexState&Ie)===ke&&(i._duplexState|=_),this.pipeTo!==null&&this.pipeTo.end()),(i._duplexState&_e)===_){(i._duplexState&Ee)===0&&(i._duplexState|=ye,i._destroy(Pe.bind(this)));return}(i._duplexState&De)===l&&(i._duplexState=(i._duplexState|ye)&O,i._open(qe.bind(this)))}continueUpdate(){return(this.stream._duplexState&F)===0?!1:(this.stream._duplexState&=q,!0)}updateCallback(){(this.stream._duplexState&et)===P?this.update():this.updateNextTick()}updateNextTickIfOpen(){(this.stream._duplexState&tt)===0&&(this.stream._duplexState|=F,(this.stream._duplexState&b)===0&&queueMicrotask(this.afterUpdateNextTick))}updateNextTick(){(this.stream._duplexState&F)===0&&(this.stream._duplexState|=F,(this.stream._duplexState&b)===0&&queueMicrotask(this.afterUpdateNextTick))}}class ht{constructor(i){this.data=null,this.afterTransform=xt.bind(i),this.afterFinal=null}}class ft{constructor(i,E,Y){this.from=i,this.to=E,this.afterPipe=Y,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(i,E){if(E&&(this.error=E),i===this.to&&(this.to=null,this.from!==null)){((this.from._duplexState&S)===0||!this.pipeToFinished)&&this.from.destroy(this.error||new Error("Writable stream closed prematurely"));return}if(i===this.from&&(this.from=null,this.to!==null)){(i._duplexState&S)===0&&this.to.destroy(this.error||new Error("Readable stream closed before ending"));return}this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null}}function _t(){this.stream._duplexState|=z,this.updateCallback()}function pt(R){const i=this.stream;R&&i.destroy(R),(i._duplexState&_e)===0&&(i._duplexState|=oe,i.emit("finish")),(i._duplexState&Ie)===ke&&(i._duplexState|=_),i._duplexState&=G,(i._duplexState&ne)===0?this.update():this.updateNextTick()}function Pe(R){const i=this.stream;!R&&this.error!==e&&(R=this.error),R&&i.emit("error",R),i._duplexState|=p,i.emit("close");const E=i._readableState,Y=i._writableState;if(E!==null&&E.pipeline!==null&&E.pipeline.done(i,R),Y!==null){for(;Y.drains!==null&&Y.drains.length>0;)Y.drains.shift().resolve(!1);Y.pipeline!==null&&Y.pipeline.done(i,R)}}function gt(R){const i=this.stream;R&&i.destroy(R),i._duplexState&=f,this.drains!==null&&yt(this.drains),(i._duplexState&it)===ce&&(i._duplexState&=Z,(i._duplexState&ue)===ue&&i.emit("drain")),this.updateCallback()}function bt(R){R&&this.stream.destroy(R),this.stream._duplexState&=de,this.readAhead===!1&&(this.stream._duplexState&x)===0&&(this.stream._duplexState&=N),this.updateCallback()}function wt(){(this.stream._duplexState&b)===0&&(this.stream._duplexState&=q,this.update())}function mt(){(this.stream._duplexState&ne)===0&&(this.stream._duplexState&=be,this.update())}function yt(R){for(let i=0;i<R.length;i++)--R[i].writes===0&&(R.shift().resolve(!0),i--)}function qe(R){const i=this.stream;R&&i.destroy(R),(i._duplexState&_)===0&&((i._duplexState&Ke)===0&&(i._duplexState|=P),(i._duplexState&nt)===0&&(i._duplexState|=re),i.emit("open")),i._duplexState&=je,i._writableState!==null&&i._writableState.updateCallback(),i._readableState!==null&&i._readableState.updateCallback()}function xt(R,i){i!=null&&this.push(i),this._writableState.afterWrite(R)}function St(R){this._readableState!==null&&(R==="data"&&(this._duplexState|=se|te,this._readableState.updateNextTick()),R==="readable"&&(this._duplexState|=v,this._readableState.updateNextTick())),this._writableState!==null&&R==="drain"&&(this._duplexState|=ue,this._writableState.updateNextTick())}class Te extends n{constructor(i){super(),this._duplexState=0,this._readableState=null,this._writableState=null,i&&(i.open&&(this._open=i.open),i.destroy&&(this._destroy=i.destroy),i.predestroy&&(this._predestroy=i.predestroy),i.signal&&i.signal.addEventListener("abort",Dt.bind(this))),this.on("newListener",St)}_open(i){i(null)}_destroy(i){i(null)}_predestroy(){}get readable(){return this._readableState!==null?!0:void 0}get writable(){return this._writableState!==null?!0:void 0}get destroyed(){return(this._duplexState&p)!==0}get destroying(){return(this._duplexState&_e)!==0}destroy(i){(this._duplexState&_e)===0&&(i||(i=e),this._duplexState=(this._duplexState|_)&Ge,this._readableState!==null&&(this._readableState.highWaterMark=0,this._readableState.error=i),this._writableState!==null&&(this._writableState.highWaterMark=0,this._writableState.error=i),this._duplexState|=c,this._predestroy(),this._duplexState&=D,this._readableState!==null&&this._readableState.updateNextTick(),this._writableState!==null&&this._writableState.updateNextTick())}}class xe extends Te{constructor(i){super(i),this._duplexState|=l|oe|g,this._readableState=new dt(this,i),i&&(this._readableState.readAhead===!1&&(this._duplexState&=N),i.read&&(this._read=i.read),i.eagerOpen&&this._readableState.updateNextTick(),i.encoding&&this.setEncoding(i.encoding))}setEncoding(i){const E=new s(i),Y=this._readableState.map||kt;return this._readableState.map=X,this;function X(ae){const ie=E.push(ae);return ie===""&&(ae.byteLength!==0||E.remaining>0)?null:Y(ie)}}_read(i){i(null)}pipe(i,E){return this._readableState.updateNextTick(),this._readableState.pipe(i,E),i}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(i){return this._readableState.updateNextTickIfOpen(),this._readableState.push(i)}unshift(i){return this._readableState.updateNextTickIfOpen(),this._readableState.unshift(i)}resume(){return this._duplexState|=te,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=this._readableState.readAhead===!1?U:j,this}static _fromAsyncIterator(i,E){let Y;const X=new xe({...E,read(ie){i.next().then(ae).then(ie.bind(null,null)).catch(ie)},predestroy(){Y=i.return()},destroy(ie){if(!Y)return ie(null);Y.then(ie.bind(null,null)).catch(ie)}});return X;function ae(ie){ie.done?X.push(null):X.push(ie.value)}}static from(i,E){if(Rt(i))return i;if(i[Oe])return this._fromAsyncIterator(i[Oe](),E);Array.isArray(i)||(i=i===void 0?[]:[i]);let Y=0;return new xe({...E,read(X){this.push(Y===i.length?null:i[Y++]),X(null)}})}static isBackpressured(i){return(i._duplexState&Ze)!==0||i._readableState.buffered>=i._readableState.highWaterMark}static isPaused(i){return(i._duplexState&x)===0}[Oe](){const i=this;let E=null,Y=null,X=null;return this.on("error",ee=>{E=ee}),this.on("readable",ae),this.on("close",ie),{[Oe](){return this},next(){return new Promise(function(ee,pe){Y=ee,X=pe;const ge=i.read();ge!==null?we(ge):(i._duplexState&p)!==0&&we(null)})},return(){return ve(null)},throw(ee){return ve(ee)}};function ae(){Y!==null&&we(i.read())}function ie(){Y!==null&&we(null)}function we(ee){X!==null&&(E?X(E):ee===null&&(i._duplexState&S)===0?X(e):Y({value:ee,done:ee===null}),X=Y=null)}function ve(ee){return i.destroy(ee),new Promise((pe,ge)=>{if(i._duplexState&p)return pe({value:void 0,done:!0});i.once("close",function(){ee?ge(ee):pe({value:void 0,done:!0})})})}}}class Me extends Te{constructor(i){super(i),this._duplexState|=l|S,this._writableState=new We(this,i),i&&(i.writev&&(this._writev=i.writev),i.write&&(this._write=i.write),i.final&&(this._final=i.final),i.eagerOpen&&this._writableState.updateNextTick())}cork(){this._duplexState|=d}uncork(){this._duplexState&=Re,this._writableState.updateNextTick()}_writev(i,E){E(null)}_write(i,E){this._writableState.autoBatch(i,E)}_final(i){i(null)}static isBackpressured(i){return(i._duplexState&ct)!==0}static drained(i){if(i.destroyed)return Promise.resolve(!1);const E=i._writableState,X=(Ft(i)?Math.min(1,E.queue.length):E.queue.length)+(i._duplexState&me?1:0);return X===0?Promise.resolve(!0):(E.drains===null&&(E.drains=[]),new Promise(ae=>{E.drains.push({writes:X,resolve:ae})}))}write(i){return this._writableState.updateNextTick(),this._writableState.push(i)}end(i){return this._writableState.updateNextTick(),this._writableState.end(i),this}}class Ae extends xe{constructor(i){super(i),this._duplexState=l|this._duplexState&g,this._writableState=new We(this,i),i&&(i.writev&&(this._writev=i.writev),i.write&&(this._write=i.write),i.final&&(this._final=i.final))}cork(){this._duplexState|=d}uncork(){this._duplexState&=Re,this._writableState.updateNextTick()}_writev(i,E){E(null)}_write(i,E){this._writableState.autoBatch(i,E)}_final(i){i(null)}write(i){return this._writableState.updateNextTick(),this._writableState.push(i)}end(i){return this._writableState.updateNextTick(),this._writableState.end(i),this}}class Ue extends Ae{constructor(i){super(i),this._transformState=new ht(this),i&&(i.transform&&(this._transform=i.transform),i.flush&&(this._flush=i.flush))}_write(i,E){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=i:this._transform(i,this._transformState.afterTransform)}_read(i){if(this._transformState.data!==null){const E=this._transformState.data;this._transformState.data=null,i(null),this._transform(E,this._transformState.afterTransform)}else i(null)}destroy(i){super.destroy(i),this._transformState.data!==null&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(i,E){E(null,i)}_flush(i){i(null)}_final(i){this._transformState.afterFinal=i,this._flush(Et.bind(this))}}class vt extends Ue{}function Et(R,i){const E=this._transformState.afterFinal;if(R)return E(R);i!=null&&this.push(i),this.push(null),E(null)}function Ot(...R){return new Promise((i,E)=>He(...R,Y=>{if(Y)return E(Y);i()}))}function He(R,...i){const E=Array.isArray(R)?[...R,...i]:[R,...i],Y=E.length&&typeof E[E.length-1]=="function"?E.pop():null;if(E.length<2)throw new Error("Pipeline requires at least 2 streams");let X=E[0],ae=null,ie=null;for(let ee=1;ee<E.length;ee++)ae=E[ee],Se(X)?X.pipe(ae,ve):(we(X,!0,ee>1,ve),X.pipe(ae)),X=ae;if(Y){let ee=!1;const pe=Se(ae)||!!(ae._writableState&&ae._writableState.autoDestroy);ae.on("error",ge=>{ie===null&&(ie=ge)}),ae.on("finish",()=>{ee=!0,pe||Y(ie)}),pe&&ae.on("close",()=>Y(ie||(ee?null:t)))}return ae;function we(ee,pe,ge,Le){ee.on("error",Le),ee.on("close",Ct);function Ct(){if(ee._readableState&&!ee._readableState.ended||ge&&ee._writableState&&!ee._writableState.ended)return Le(t)}}function ve(ee){if(!(!ee||ie)){ie=ee;for(const pe of E)pe.destroy(ee)}}}function kt(R){return R}function ze(R){return!!R._readableState||!!R._writableState}function Se(R){return typeof R._duplexState=="number"&&ze(R)}function Tt(R){return!!R._readableState&&R._readableState.ended}function At(R){return!!R._writableState&&R._writableState.ended}function Lt(R,i={}){const E=R._readableState&&R._readableState.error||R._writableState&&R._writableState.error;return!i.all&&E===e?null:E}function Rt(R){return Se(R)&&R.readable}function jt(R){return(R._duplexState&l)!==l||(R._duplexState&Ee)!==0}function It(R){return typeof R=="object"&&R!==null&&typeof R.byteLength=="number"}function Ve(R){return It(R)?R.byteLength:1024}function $e(){}function Dt(){this.destroy(new Error("Stream aborted."))}function Ft(R){return R._writev!==Me.prototype._writev&&R._writev!==Ae.prototype._writev}return streamx={pipeline:He,pipelinePromise:Ot,isStream:ze,isStreamx:Se,isEnded:Tt,isFinished:At,isDisturbed:jt,getStreamError:Lt,Stream:Te,Writable:Me,Readable:xe,Duplex:Ae,Transform:Ue,PassThrough:vt},streamx}var browser={exports:{}},ascii,hasRequiredAscii;function requireAscii(){if(hasRequiredAscii)return ascii;hasRequiredAscii=1;function n(r){return r.length}function e(r){const s=r.byteLength;let a="";for(let l=0;l<s;l++)a+=String.fromCharCode(r[l]);return a}function t(r,s,a=0,l=n(s)){const c=Math.min(l,r.byteLength-a);for(let _=0;_<c;_++)r[a+_]=s.charCodeAt(_);return c}return ascii={byteLength:n,toString:e,write:t},ascii}var base64,hasRequiredBase64;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256);for(let a=0;a<n.length;a++)e[n.charCodeAt(a)]=a;e[45]=62,e[95]=63;function t(a){let l=a.length;return a.charCodeAt(l-1)===61&&l--,l>1&&a.charCodeAt(l-1)===61&&l--,l*3>>>2}function r(a){const l=a.byteLength;let c="";for(let _=0;_<l;_+=3)c+=n[a[_]>>2]+n[(a[_]&3)<<4|a[_+1]>>4]+n[(a[_+1]&15)<<2|a[_+2]>>6]+n[a[_+2]&63];return l%3===2?c=c.substring(0,c.length-1)+"=":l%3===1&&(c=c.substring(0,c.length-2)+"=="),c}function s(a,l,c=0,_=t(l)){const p=Math.min(_,a.byteLength-c);for(let O=0,D=0;D<p;O+=4){const $=e[l.charCodeAt(O)],b=e[l.charCodeAt(O+1)],P=e[l.charCodeAt(O+2)],B=e[l.charCodeAt(O+3)];a[D++]=$<<2|b>>4,a[D++]=(b&15)<<4|P>>2,a[D++]=(P&3)<<6|B&63}return p}return base64={byteLength:t,toString:r,write:s},base64}var hex,hasRequiredHex;function requireHex(){if(hasRequiredHex)return hex;hasRequiredHex=1;function n(s){return s.length>>>1}function e(s){const a=s.byteLength;s=new DataView(s.buffer,s.byteOffset,a);let l="",c=0;for(let _=a-a%4;c<_;c+=4)l+=s.getUint32(c).toString(16).padStart(8,"0");for(;c<a;c++)l+=s.getUint8(c).toString(16).padStart(2,"0");return l}function t(s,a,l=0,c=n(a)){const _=Math.min(c,s.byteLength-l);for(let p=0;p<_;p++){const O=r(a.charCodeAt(p*2)),D=r(a.charCodeAt(p*2+1));if(O===void 0||D===void 0)return s.subarray(0,p);s[l+p]=O<<4|D}return _}hex={byteLength:n,toString:e,write:t};function r(s){if(s>=48&&s<=57)return s-48;if(s>=65&&s<=70)return s-65+10;if(s>=97&&s<=102)return s-97+10}return hex}var utf8,hasRequiredUtf8;function requireUtf8(){if(hasRequiredUtf8)return utf8;hasRequiredUtf8=1;function n(r){let s=0;for(let a=0,l=r.length;a<l;a++){const c=r.charCodeAt(a);if(c>=55296&&c<=56319&&a+1<l){const _=r.charCodeAt(a+1);if(_>=56320&&_<=57343){s+=4,a++;continue}}c<=127?s+=1:c<=2047?s+=2:s+=3}return s}let e;if(typeof TextDecoder<"u"){const r=new TextDecoder;e=function(a){return r.decode(a)}}else e=function(s){const a=s.byteLength;let l="",c=0;for(;c<a;){let _=s[c];if(_<=127){l+=String.fromCharCode(_),c++;continue}let p=0,O=0;if(_<=223?(p=1,O=_&31):_<=239?(p=2,O=_&15):_<=244&&(p=3,O=_&7),a-c-p>0){let D=0;for(;D<p;)_=s[c+D+1],O=O<<6|_&63,D+=1}else O=65533,p=a-c;l+=String.fromCodePoint(O),c+=p+1}return l};let t;if(typeof TextEncoder<"u"){const r=new TextEncoder;t=function(a,l,c=0,_=n(l)){const p=Math.min(_,a.byteLength-c);return r.encodeInto(l,a.subarray(c,c+p)),p}}else t=function(s,a,l=0,c=n(a)){const _=Math.min(c,s.byteLength-l);s=s.subarray(l,l+_);let p=0,O=0;for(;p<a.length;){const D=a.codePointAt(p);if(D<=127){s[O++]=D,p++;continue}let $=0,b=0;for(D<=2047?($=6,b=192):D<=65535?($=12,b=224):D<=2097151&&($=18,b=240),s[O++]=b|D>>$,$-=6;$>=0;)s[O++]=128|D>>$&63,$-=6;p+=D>=65536?2:1}return _};return utf8={byteLength:n,toString:e,write:t},utf8}var utf16le,hasRequiredUtf16le;function requireUtf16le(){if(hasRequiredUtf16le)return utf16le;hasRequiredUtf16le=1;function n(r){return r.length*2}function e(r){const s=r.byteLength;let a="";for(let l=0;l<s-1;l+=2)a+=String.fromCharCode(r[l]+r[l+1]*256);return a}function t(r,s,a=0,l=n(s)){const c=Math.min(l,r.byteLength-a);let _=c;for(let p=0;p<s.length&&!((_-=2)<0);++p){const O=s.charCodeAt(p),D=O>>8,$=O%256;r[a+p*2]=$,r[a+p*2+1]=D}return c}return utf16le={byteLength:n,toString:e,write:t},utf16le}var hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(n,e){const t=requireAscii(),r=requireBase64(),s=requireHex(),a=requireUtf8(),l=requireUtf16le(),c=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function _(o){switch(o){case"ascii":return t;case"base64":return r;case"hex":return s;case"utf8":case"utf-8":case void 0:case null:return a;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l;default:throw new Error(`Unknown encoding: ${o}`)}}function p(o){return o instanceof Uint8Array}function O(o){try{return _(o),!0}catch{return!1}}function D(o,d,f){const A=new Uint8Array(o);return d!==void 0&&e.fill(A,d,0,A.byteLength,f),A}function $(o){return new Uint8Array(o)}function b(o){return new Uint8Array(o)}function P(o,d){return _(d).byteLength(o)}function B(o,d){if(o===d)return 0;const f=Math.min(o.byteLength,d.byteLength);o=new DataView(o.buffer,o.byteOffset,o.byteLength),d=new DataView(d.buffer,d.byteOffset,d.byteLength);let A=0;for(let G=f-f%4;A<G;A+=4){const Z=o.getUint32(A,c),le=d.getUint32(A,c);if(Z!==le)break}for(;A<f;A++){const G=o.getUint8(A),Z=d.getUint8(A);if(G<Z)return-1;if(G>Z)return 1}return o.byteLength>d.byteLength?1:o.byteLength<d.byteLength?-1:0}function x(o,d){d===void 0&&(d=o.reduce((G,Z)=>G+Z.byteLength,0));const f=new Uint8Array(d);let A=0;for(const G of o){if(A+G.byteLength>f.byteLength){const Z=G.subarray(0,f.byteLength-A);return f.set(Z,A),f}f.set(G,A),A+=G.byteLength}return f}function z(o,d,f=0,A=0,G=o.byteLength){if(G>0&&G<A||G===A||o.byteLength===0||d.byteLength===0)return 0;if(f<0)throw new RangeError("targetStart is out of range");if(A<0||A>=o.byteLength)throw new RangeError("sourceStart is out of range");if(G<0)throw new RangeError("sourceEnd is out of range");f>=d.byteLength&&(f=d.byteLength),G>o.byteLength&&(G=o.byteLength),d.byteLength-f<G-A&&(G=d.length-f+A);const Z=G-A;return o===d?d.copyWithin(f,A,G):d.set(o.subarray(A,G),f),Z}function K(o,d){if(o===d)return!0;if(o.byteLength!==d.byteLength)return!1;const f=o.byteLength;o=new DataView(o.buffer,o.byteOffset,o.byteLength),d=new DataView(d.buffer,d.byteOffset,d.byteLength);let A=0;for(let G=f-f%4;A<G;A+=4)if(o.getUint32(A,c)!==d.getUint32(A,c))return!1;for(;A<f;A++)if(o.getUint8(A)!==d.getUint8(A))return!1;return!0}function se(o,d,f,A,G){if(typeof d=="string"?typeof f=="string"?(G=f,f=0,A=o.byteLength):typeof A=="string"&&(G=A,A=o.byteLength):typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=+d),f<0||o.byteLength<f||o.byteLength<A)throw new RangeError("Out of range index");if(f===void 0&&(f=0),A===void 0&&(A=o.byteLength),A<=f)return o;if(d||(d=0),typeof d=="number")for(let Z=f;Z<A;++Z)o[Z]=d;else{d=p(d)?d:v(d,G);const Z=d.byteLength;for(let le=0;le<A-f;++le)o[le+f]=d[le%Z]}return o}function v(o,d,f){return typeof o=="string"?m(o,d):Array.isArray(o)?S(o):ArrayBuffer.isView(o)?F(o):k(o,d,f)}function m(o,d){const f=_(d),A=new Uint8Array(f.byteLength(o));return f.write(A,o,0,A.byteLength),A}function S(o){const d=new Uint8Array(o.length);return d.set(o),d}function F(o){const d=new Uint8Array(o.byteLength);return d.set(o),d}function k(o,d,f){return new Uint8Array(o,d,f)}function g(o,d,f,A){return T(o,d,f,A)!==-1}function u(o,d,f,A,G){if(o.byteLength===0)return-1;if(typeof f=="string"?(A=f,f=0):f===void 0?f=G?0:o.length-1:f<0&&(f+=o.byteLength),f>=o.byteLength){if(G)return-1;f=o.byteLength-1}else if(f<0)if(G)f=0;else return-1;if(typeof d=="string")d=v(d,A);else if(typeof d=="number")return d=d&255,G?o.indexOf(d,f):o.lastIndexOf(d,f);if(d.byteLength===0)return-1;if(G){let Z=-1;for(let le=f;le<o.byteLength;le++)if(o[le]===d[Z===-1?0:le-Z]){if(Z===-1&&(Z=le),le-Z+1===d.byteLength)return Z}else Z!==-1&&(le-=le-Z),Z=-1}else{f+d.byteLength>o.byteLength&&(f=o.byteLength-d.byteLength);for(let Z=f;Z>=0;Z--){let le=!0;for(let be=0;be<d.byteLength;be++)if(o[Z+be]!==d[be]){le=!1;break}if(le)return Z}}return-1}function T(o,d,f,A){return u(o,d,f,A,!0)}function M(o,d,f,A){return u(o,d,f,A,!1)}function J(o,d,f){const A=o[d];o[d]=o[f],o[f]=A}function te(o){const d=o.byteLength;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<d;f+=2)J(o,f,f+1);return o}function de(o){const d=o.byteLength;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<d;f+=4)J(o,f,f+3),J(o,f+1,f+2);return o}function w(o){const d=o.byteLength;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<d;f+=8)J(o,f,f+7),J(o,f+1,f+6),J(o,f+2,f+5),J(o,f+3,f+4);return o}function I(o){return o}function H(o,d,f=0,A=o.byteLength){const G=o.byteLength;return f>=G||A<=f?"":(f<0&&(f=0),A>G&&(A=G),(f!==0||A<G)&&(o=o.subarray(f,A)),_(d).toString(o))}function j(o,d,f,A,G){return f===void 0?G="utf8":A===void 0&&typeof f=="string"?(G=f,f=void 0):G===void 0&&typeof A=="string"&&(G=A,A=void 0),_(G).write(o,d,f,A)}function L(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(f,d,!0),f+8}function y(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(f,d,!0),f+4}function W(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(f,d,!0),f+4}function q(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(f,d,!0),f+4}function C(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getFloat64(d,!0)}function N(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getFloat32(d,!0)}function U(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getUint32(d,!0)}function V(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getInt32(d,!0)}function ne(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(f,d,!1),f+8}function re(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(f,d,!1),f+4}function Q(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(f,d,!1),f+4}function ce(o,d,f){return f===void 0&&(f=0),new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(f,d,!1),f+4}function oe(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getFloat64(d,!1)}function ue(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getFloat32(d,!1)}function fe(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getUint32(d,!1)}function me(o,d){return d===void 0&&(d=0),new DataView(o.buffer,o.byteOffset,o.byteLength).getInt32(d,!1)}n.exports=e={isBuffer:p,isEncoding:O,alloc:D,allocUnsafe:$,allocUnsafeSlow:b,byteLength:P,compare:B,concat:x,copy:z,equals:K,fill:se,from:v,includes:g,indexOf:T,lastIndexOf:M,swap16:te,swap32:de,swap64:w,toBuffer:I,toString:H,write:j,writeDoubleLE:L,writeFloatLE:y,writeUInt32LE:W,writeInt32LE:q,readDoubleLE:C,readFloatLE:N,readUInt32LE:U,readInt32LE:V,writeDoubleBE:ne,writeFloatBE:re,writeUInt32BE:Q,writeInt32BE:ce,readDoubleBE:oe,readFloatBE:ue,readUInt32BE:fe,readInt32BE:me}}(browser,browser.exports)),browser.exports}var headers={},hasRequiredHeaders;function requireHeaders(){if(hasRequiredHeaders)return headers;hasRequiredHeaders=1;const n=requireBrowser(),e="0000000000000000000",t="7777777777777777777",r=48,s=n.from([117,115,116,97,114,0]),a=n.from([r,r]),l=n.from([117,115,116,97,114,32]),c=n.from([32,0]),_=4095,p=257,O=263;headers.decodeLongPath=function(u,T){return F(u,0,u.length,T)},headers.encodePax=function(u){let T="";u.name&&(T+=k(" path="+u.name+`
`)),u.linkname&&(T+=k(" linkpath="+u.linkname+`
`));const M=u.pax;if(M)for(const J in M)T+=k(" "+J+"="+M[J]+`
`);return n.from(T)},headers.decodePax=function(u){const T={};for(;u.length;){let M=0;for(;M<u.length&&u[M]!==32;)M++;const J=parseInt(n.toString(u.subarray(0,M)),10);if(!J)return T;const te=n.toString(u.subarray(M+1,J-1)),de=te.indexOf("=");if(de===-1)return T;T[te.slice(0,de)]=te.slice(de+1),u=u.subarray(J)}return T},headers.encode=function(u){const T=n.alloc(512);let M=u.name,J="";if(u.typeflag===5&&M[M.length-1]!=="/"&&(M+="/"),n.byteLength(M)!==M.length)return null;for(;n.byteLength(M)>100;){const te=M.indexOf("/");if(te===-1)return null;J+=J?"/"+M.slice(0,te):M.slice(0,te),M=M.slice(te+1)}return n.byteLength(M)>100||n.byteLength(J)>155||u.linkname&&n.byteLength(u.linkname)>100?null:(n.write(T,M),n.write(T,K(u.mode&_,6),100),n.write(T,K(u.uid,6),108),n.write(T,K(u.gid,6),116),v(u.size,T,124),n.write(T,K(u.mtime.getTime()/1e3|0,11),136),T[156]=r+B(u.type),u.linkname&&n.write(T,u.linkname,157),n.copy(s,T,p),n.copy(a,T,O),u.uname&&n.write(T,u.uname,265),u.gname&&n.write(T,u.gname,297),n.write(T,K(u.devmajor||0,6),329),n.write(T,K(u.devminor||0,6),337),J&&n.write(T,J,345),n.write(T,K(z(T),6),148),T)},headers.decode=function(u,T,M){let J=u[156]===0?0:u[156]-r,te=F(u,0,100,T);const de=S(u,100,8),w=S(u,108,8),I=S(u,116,8),H=S(u,124,12),j=S(u,136,12),L=P(J),y=u[157]===0?null:F(u,157,100,T),W=F(u,265,32),q=F(u,297,32),C=S(u,329,8),N=S(u,337,8),U=z(u);if(U===8*32)return null;if(U!==S(u,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(D(u))u[345]&&(te=F(u,345,155,T)+"/"+te);else if(!$(u)){if(!M)throw new Error("Invalid tar header: unknown format.")}return J===0&&te&&te[te.length-1]==="/"&&(J=5),{name:te,mode:de,uid:w,gid:I,size:H,mtime:new Date(1e3*j),type:L,linkname:y,uname:W,gname:q,devmajor:C,devminor:N,pax:null}};function D(g){return n.equals(s,g.subarray(p,p+6))}function $(g){return n.equals(l,g.subarray(p,p+6))&&n.equals(c,g.subarray(O,O+2))}function b(g,u,T){return typeof g!="number"?T:(g=~~g,g>=u?u:g>=0||(g+=u,g>=0)?g:0)}function P(g){switch(g){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}function B(g){switch(g){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}function x(g,u,T,M){for(;T<M;T++)if(g[T]===u)return T;return M}function z(g){let u=256;for(let T=0;T<148;T++)u+=g[T];for(let T=156;T<512;T++)u+=g[T];return u}function K(g,u){return g=g.toString(8),g.length>u?t.slice(0,u)+" ":e.slice(0,u-g.length)+g+" "}function se(g,u,T){u[T]=128;for(let M=11;M>0;M--)u[T+M]=g&255,g=Math.floor(g/256)}function v(g,u,T){g.toString(8).length>11?se(g,u,T):n.write(u,K(g,11),T)}function m(g){let u;if(g[0]===128)u=!0;else if(g[0]===255)u=!1;else return null;const T=[];let M;for(M=g.length-1;M>0;M--){const de=g[M];u?T.push(de):T.push(255-de)}let J=0;const te=T.length;for(M=0;M<te;M++)J+=T[M]*Math.pow(256,M);return u?J:-1*J}function S(g,u,T){if(g=g.subarray(u,u+T),u=0,g[u]&128)return m(g);{for(;u<g.length&&g[u]===32;)u++;const M=b(x(g,32,u,g.length),g.length,g.length);for(;u<M&&g[u]===0;)u++;return M===u?0:parseInt(n.toString(g.subarray(u,M)),8)}}function F(g,u,T,M){return n.toString(g.subarray(u,x(g,0,u,u+T)),M)}function k(g){const u=n.byteLength(g);let T=Math.floor(Math.log(u)/Math.log(10))+1;return u+T>=Math.pow(10,T)&&T++,u+T+g}return headers}var extract,hasRequiredExtract;function requireExtract(){if(hasRequiredExtract)return extract;hasRequiredExtract=1;const{Writable:n,Readable:e,getStreamError:t}=requireStreamx(),r=requireFastFifo(),s=requireBrowser(),a=requireHeaders(),l=s.alloc(0);class c{constructor(){this.buffered=0,this.shifted=0,this.queue=new r,this._offset=0}push(b){this.buffered+=b.byteLength,this.queue.push(b)}shiftFirst(b){return this._buffered===0?null:this._next(b)}shift(b){if(b>this.buffered)return null;if(b===0)return l;let P=this._next(b);if(b===P.byteLength)return P;const B=[P];for(;(b-=P.byteLength)>0;)P=this._next(b),B.push(P);return s.concat(B)}_next(b){const P=this.queue.peek(),B=P.byteLength-this._offset;if(b>=B){const x=this._offset?P.subarray(this._offset,P.byteLength):P;return this.queue.shift(),this._offset=0,this.buffered-=B,this.shifted+=B,x}return this.buffered-=b,this.shifted+=b,P.subarray(this._offset,this._offset+=b)}}class _ extends e{constructor(b,P,B){super(),this.header=P,this.offset=B,this._parent=b}_read(b){this.header.size===0&&this.push(null),this._parent._stream===this&&this._parent._update(),b(null)}_predestroy(){this._parent.destroy(t(this))}_detach(){this._parent._stream===this&&(this._parent._stream=null,this._parent._missing=D(this.header.size),this._parent._update())}_destroy(b){this._detach(),b(null)}}class p extends n{constructor(b){super(b),b||(b={}),this._buffer=new c,this._offset=0,this._header=null,this._stream=null,this._missing=0,this._longHeader=!1,this._callback=O,this._locked=!1,this._finished=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null,this._filenameEncoding=b.filenameEncoding||"utf-8",this._allowUnknownFormat=!!b.allowUnknownFormat,this._unlockBound=this._unlock.bind(this)}_unlock(b){if(this._locked=!1,b){this.destroy(b),this._continueWrite(b);return}this._update()}_consumeHeader(){if(this._locked)return!1;this._offset=this._buffer.shifted;try{this._header=a.decode(this._buffer.shift(512),this._filenameEncoding,this._allowUnknownFormat)}catch(b){return this._continueWrite(b),!1}if(!this._header)return!0;switch(this._header.type){case"gnu-long-path":case"gnu-long-link-path":case"pax-global-header":case"pax-header":return this._longHeader=!0,this._missing=this._header.size,!0}return this._locked=!0,this._applyLongHeaders(),this._header.size===0||this._header.type==="directory"?(this.emit("entry",this._header,this._createStream(),this._unlockBound),!0):(this._stream=this._createStream(),this._missing=this._header.size,this.emit("entry",this._header,this._stream,this._unlockBound),!0)}_applyLongHeaders(){this._gnuLongPath&&(this._header.name=this._gnuLongPath,this._gnuLongPath=null),this._gnuLongLinkPath&&(this._header.linkname=this._gnuLongLinkPath,this._gnuLongLinkPath=null),this._pax&&(this._pax.path&&(this._header.name=this._pax.path),this._pax.linkpath&&(this._header.linkname=this._pax.linkpath),this._pax.size&&(this._header.size=parseInt(this._pax.size,10)),this._header.pax=this._pax,this._pax=null)}_decodeLongHeader(b){switch(this._header.type){case"gnu-long-path":this._gnuLongPath=a.decodeLongPath(b,this._filenameEncoding);break;case"gnu-long-link-path":this._gnuLongLinkPath=a.decodeLongPath(b,this._filenameEncoding);break;case"pax-global-header":this._paxGlobal=a.decodePax(b);break;case"pax-header":this._pax=this._paxGlobal===null?a.decodePax(b):Object.assign({},this._paxGlobal,a.decodePax(b));break}}_consumeLongHeader(){this._longHeader=!1,this._missing=D(this._header.size);const b=this._buffer.shift(this._header.size);try{this._decodeLongHeader(b)}catch(P){return this._continueWrite(P),!1}return!0}_consumeStream(){const b=this._buffer.shiftFirst(this._missing);if(b===null)return!1;this._missing-=b.byteLength;const P=this._stream.push(b);return this._missing===0?(this._stream.push(null),P&&this._stream._detach(),P&&this._locked===!1):P}_createStream(){return new _(this,this._header,this._offset)}_update(){for(;this._buffer.buffered>0&&!this.destroying;){if(this._missing>0){if(this._stream!==null){if(this._consumeStream()===!1)return;continue}if(this._longHeader===!0){if(this._missing>this._buffer.buffered)break;if(this._consumeLongHeader()===!1)return!1;continue}const b=this._buffer.shiftFirst(this._missing);b!==null&&(this._missing-=b.byteLength);continue}if(this._buffer.buffered<512)break;if(this._stream!==null||this._consumeHeader()===!1)return}this._continueWrite(null)}_continueWrite(b){const P=this._callback;this._callback=O,P(b)}_write(b,P){this._callback=P,this._buffer.push(b),this._update()}_final(b){this._finished=this._missing===0&&this._buffer.buffered===0,b(this._finished?null:new Error("Unexpected end of data"))}_predestroy(){this._continueWrite(null)}_destroy(b){this._stream&&this._stream.destroy(t(this)),b(null)}[Symbol.asyncIterator](){let b=null,P=null,B=null,x=null,z=null;const K=this;return this.on("entry",m),this.on("error",k=>{b=k}),this.on("close",S),{[Symbol.asyncIterator](){return this},next(){return new Promise(v)},return(){return F(null)},throw(k){return F(k)}};function se(k){if(!z)return;const g=z;z=null,g(k)}function v(k,g){if(b)return g(b);if(x){k({value:x,done:!1}),x=null;return}P=k,B=g,se(null),K._finished&&P&&(P({value:void 0,done:!0}),P=B=null)}function m(k,g,u){z=u,g.on("error",O),P?(P({value:g,done:!1}),P=B=null):x=g}function S(){se(b),P&&(b?B(b):P({value:void 0,done:!0}),P=B=null)}function F(k){return K.destroy(k),se(k),new Promise((g,u)=>{if(K.destroyed)return g({value:void 0,done:!0});K.once("close",function(){k?u(k):g({value:void 0,done:!0})})})}}}extract=function(b){return new p(b)};function O(){}function D($){return $&=511,$&&512-$}return extract}var constants={exports:{}};const empty={},empty$1=Object.freeze(Object.defineProperty({__proto__:null,default:empty},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(empty$1);var hasRequiredConstants;function requireConstants(){if(hasRequiredConstants)return constants.exports;hasRequiredConstants=1;const n={S_IFMT:61440,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960};try{constants.exports=require$$0.constants||n}catch{constants.exports=n}return constants.exports}var pack,hasRequiredPack;function requirePack(){if(hasRequiredPack)return pack;hasRequiredPack=1;const{Readable:n,Writable:e,getStreamError:t}=requireStreamx(),r=requireBrowser(),s=requireConstants(),a=requireHeaders(),l=493,c=420,_=r.alloc(1024);class p extends e{constructor(x,z,K){super({mapWritable:P,eagerOpen:!0}),this.written=0,this.header=z,this._callback=K,this._linkname=null,this._isLinkname=z.type==="symlink"&&!z.linkname,this._isVoid=z.type!=="file"&&z.type!=="contiguous-file",this._finished=!1,this._pack=x,this._openCallback=null,this._pack._stream===null?this._pack._stream=this:this._pack._pending.push(this)}_open(x){this._openCallback=x,this._pack._stream===this&&this._continueOpen()}_continuePack(x){if(this._callback===null)return;const z=this._callback;this._callback=null,z(x)}_continueOpen(){this._pack._stream===null&&(this._pack._stream=this);const x=this._openCallback;if(this._openCallback=null,x!==null){if(this._pack.destroying)return x(new Error("pack stream destroyed"));if(this._pack._finalized)return x(new Error("pack stream is already finalized"));this._pack._stream=this,this._isLinkname||this._pack._encode(this.header),this._isVoid&&(this._finish(),this._continuePack(null)),x(null)}}_write(x,z){if(this._isLinkname)return this._linkname=this._linkname?r.concat([this._linkname,x]):x,z(null);if(this._isVoid)return x.byteLength>0?z(new Error("No body allowed for this entry")):z();if(this.written+=x.byteLength,this._pack.push(x))return z();this._pack._drain=z}_finish(){this._finished||(this._finished=!0,this._isLinkname&&(this.header.linkname=this._linkname?r.toString(this._linkname,"utf-8"):"",this._pack._encode(this.header)),b(this._pack,this.header.size),this._pack._done(this))}_final(x){if(this.written!==this.header.size)return x(new Error("Size mismatch"));this._finish(),x(null)}_getError(){return t(this)||new Error("tar entry destroyed")}_predestroy(){this._pack.destroy(this._getError())}_destroy(x){this._pack._done(this),this._continuePack(this._finished?null:this._getError()),x()}}class O extends n{constructor(x){super(x),this._drain=$,this._finalized=!1,this._finalizing=!1,this._pending=[],this._stream=null}entry(x,z,K){if(this._finalized||this.destroying)throw new Error("already finalized or destroyed");typeof z=="function"&&(K=z,z=null),K||(K=$),(!x.size||x.type==="symlink")&&(x.size=0),x.type||(x.type=D(x.mode)),x.mode||(x.mode=x.type==="directory"?l:c),x.uid||(x.uid=0),x.gid||(x.gid=0),x.mtime||(x.mtime=new Date),typeof z=="string"&&(z=r.from(z));const se=new p(this,x,K);return r.isBuffer(z)?(x.size=z.byteLength,se.write(z),se.end(),se):(se._isVoid,se)}finalize(){if(this._stream||this._pending.length>0){this._finalizing=!0;return}this._finalized||(this._finalized=!0,this.push(_),this.push(null))}_done(x){x===this._stream&&(this._stream=null,this._finalizing&&this.finalize(),this._pending.length&&this._pending.shift()._continueOpen())}_encode(x){if(!x.pax){const z=a.encode(x);if(z){this.push(z);return}}this._encodePax(x)}_encodePax(x){const z=a.encodePax({name:x.name,linkname:x.linkname,pax:x.pax}),K={name:"PaxHeader",mode:x.mode,uid:x.uid,gid:x.gid,size:z.byteLength,mtime:x.mtime,type:"pax-header",linkname:x.linkname&&"PaxHeader",uname:x.uname,gname:x.gname,devmajor:x.devmajor,devminor:x.devminor};this.push(a.encode(K)),this.push(z),b(this,z.byteLength),K.size=x.size,K.type=x.type,this.push(a.encode(K))}_doDrain(){const x=this._drain;this._drain=$,x()}_predestroy(){const x=t(this);for(this._stream&&this._stream.destroy(x);this._pending.length;){const z=this._pending.shift();z.destroy(x),z._continueOpen()}this._doDrain()}_read(x){this._doDrain(),x()}}pack=function(x){return new O(x)};function D(B){switch(B&s.S_IFMT){case s.S_IFBLK:return"block-device";case s.S_IFCHR:return"character-device";case s.S_IFDIR:return"directory";case s.S_IFIFO:return"fifo";case s.S_IFLNK:return"symlink"}return"file"}function $(){}function b(B,x){x&=511,x&&B.push(_.subarray(0,512-x))}function P(B){return r.isBuffer(B)?B:r.from(B)}return pack}var hasRequiredTarStream;function requireTarStream(){return hasRequiredTarStream||(hasRequiredTarStream=1,tarStream.extract=requireExtract(),tarStream.pack=requirePack()),tarStream}var tarStreamExports=requireTarStream();const tar=getDefaultExportFromCjs(tarStreamExports);var streamxExports=requireStreamx();function fromWeb(n,e={}){if(n instanceof ReadableStream&&n instanceof WritableStream)return new DuplexWebStream(n,n,e);if(n instanceof ReadableStream)return new ReadableWebStream(n,e);if(n instanceof WritableStream)return new WritableWebStream(n,e);if(n.readable&&n.writable)return new DuplexWebStream(n.readable,n.writable,e);if(n.readable)return new ReadableWebStream(n.readable,e);if(n.writable)return new WritableWebStream(n.writable,e);throw new Error("fromWeb: Requires at least a readable or writable stream.")}class ReadableWebStream extends streamxExports.Readable{constructor(e,t){super(t),this._reader=e.getReader(),this._attachErrorHandler()}_attachErrorHandler(){this._reader.closed.catch(e=>{this.destroy(e)})}async _read(e){try{const{done:t,value:r}=await this._reader.read();t?this.push(null):this.push(r),e()}catch(t){this.destroy(t),e(t)}}_destroy(e){this._reader.releaseLock(),e()}}class WritableWebStream extends streamxExports.Writable{constructor(e,t){super(t),this._writer=e.getWriter()}async _write(e,t){try{await this._writer.write(e),t()}catch(r){this.destroy(r),t(r)}}async _final(e){try{await this._writer.close(),e()}catch(t){this.destroy(t),e(t)}}_destroy(e){this._writer.releaseLock(),e()}}class DuplexWebStream extends streamxExports.Duplex{constructor(e,t,r){super(r),this._reader=e.getReader(),this._writer=t.getWriter(),this._attachErrorHandler(),this._handleCompletion()}_attachErrorHandler(){this._reader.closed.catch(e=>{this.destroy(e)}),this._writer.closed.catch(e=>{this.destroy(e)})}async _read(e){try{const{done:t,value:r}=await this._reader.read();t?this.push(null):this.push(r),e()}catch(t){this.destroy(t),e(t)}}async _write(e,t){try{await this._writer.write(e),t()}catch(r){this.destroy(r),t(r)}}async _final(e){try{await this._writer.close(),e()}catch(t){this.destroy(t),e(t)}}_destroy(e){this._reader.releaseLock(),this._writer.releaseLock(),e()}_handleCompletion(){this.on("finish",()=>{this.emit("end")})}}function isStreamx(n){return typeof n._duplexState=="number"&&isStream(n)}function isStream(n){return!!n._readableState||!!n._writableState}function isReadableStream(n){return!!n._readableState}function isWritableStream(n){return!!n._writableState}const WRITE_WRITING=256<<17;function drained(n,e=!1){if(n.destroyed)return Promise.resolve(!1);const t=n._writableState,s=(e?Math.min(1,t.queue.length):t.queue.length)+(n._duplexState&WRITE_WRITING?1:0);return s===0?Promise.resolve(!0):(t.drains===null&&(t.drains=[]),new Promise(a=>{t.drains.push({writes:s,resolve:a})}))}var browserExports=requireBrowser();const b4a=getDefaultExportFromCjs(browserExports);function handleReadable(n,e){let t=!1;const r={};return new ReadableStream({start(s){r.data=a,r.end=l,r.close=l,r.error=c;for(const p in r)n.on(p,r[p]);n.pause();function a(p){t||(p===null?l():(s.enqueue(typeof p=="string"?b4a.from(p):p),n.pause()))}function l(){_(),s.close()}function c(p){_(),s.error(p)}function _(){if(!t){t=!0;for(const p in r)n.off(p,r[p])}}},pull(){t||n.resume()},cancel(){t=!0;for(const s in r)n.off(s,r[s]);n.destroy?n.destroy():n.close&&n.close()},type:void 0})}function handleWritable(n){return new WritableStream({async write(e){try{const t=typeof e=="string"?b4a.from(e):e;n.write(t)||await drained(n,!1)}catch(t){n.destroy(t),setTimeout(()=>n.emit("error",t),0)}},async close(){n.end&&n.end()},abort(e){n.destroy&&n.destroy(e),setTimeout(()=>n.emit("error",e),0)}})}function toWeb(n,e){let t;if(n&&!isStreamx(n)){let a;({readable:n,writable:t,duplex:a}=n),a&&!n&&!t&&(n=a,t=a)}else isReadableStream(n)&&isWritableStream(n)?t=n:isReadableStream(n)?t=null:isWritableStream(n)&&(t=n,n=null);if(!n&&!t){const a="Invalid stream";throw new Error(a)}let r,s;return n&&(r=handleReadable(n)),t&&(s=handleWritable(t)),r&&s?{readable:r,writable:s}:r||s}const data$h={width:24,height:24,body:'<path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20z"/>'},data$g={width:24,height:24,body:'<path fill="currentColor" d="M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13h5l-5-5z"/>'},data$f={width:24,height:24,body:'<path fill="currentColor" d="m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"/>'},data$e={width:24,height:24,body:'<path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"/>'},data$d={width:24,height:24,body:'<path fill="currentColor" d="M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"/>'},data$c={width:24,height:24,body:'<path fill="currentColor" d="M21 7v12q0 .825-.587 1.413T19 21H5q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h12zm-9 11q1.25 0 2.125-.875T15 15t-.875-2.125T12 12t-2.125.875T9 15t.875 2.125T12 18m-6-8h9V6H6z"/>'},data$b={width:24,height:24,body:'<path fill="currentColor" d="M11 19h2v-4.175l1.6 1.6L16 15l-4-4l-4 4l1.425 1.4L11 14.825zm-5 3q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13h5l-5-5z"/>'},data$a={width:24,height:24,body:'<path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm7-3h2v-4.2l1.6 1.6L16 13l-4-4l-4 4l1.4 1.4l1.6-1.6z"/>'},data$9={width:24,height:24,body:'<path fill="currentColor" d="m12 18l4-4l-1.4-1.4l-1.6 1.6V10h-2v4.2l-1.6-1.6L8 14zm-7 3q-.825 0-1.412-.587T3 19V6.525q0-.35.113-.675t.337-.6L4.7 3.725q.275-.35.687-.538T6.25 3h11.5q.45 0 .863.188t.687.537l1.25 1.525q.225.275.338.6t.112.675V19q0 .825-.587 1.413T19 21zm.4-15h13.2l-.85-1H6.25z"/>'},data$8={width:24,height:24,body:'<path fill="currentColor" d="m12 10l-4 4l1.4 1.4l1.6-1.6V18h2v-4.2l1.6 1.6L16 14zM5 21q-.825 0-1.412-.587T3 19V6.525q0-.35.113-.675t.337-.6L4.7 3.725q.275-.35.687-.538T6.25 3h11.5q.45 0 .863.188t.687.537l1.25 1.525q.225.275.338.6t.112.675V19q0 .825-.587 1.413T19 21zm.4-15h13.2l-.85-1H6.25z"/>'},data$7={width:24,height:24,body:'<path fill="currentColor" d="m7.825 13l5.6 5.6L12 20l-8-8l8-8l1.425 1.4l-5.6 5.6H20v2z"/>'},PICKERS_UNAVAILABLE=!window.showDirectoryPicker||!window.showOpenFilePicker,FSAPI_UNAVAILABLE=(!window.showDirectoryPicker||!window.showOpenFilePicker)&&!DataTransferItem.prototype.getAsEntry&&!DataTransferItem.prototype.webkitGetAsEntry,rootFolder=await navigator.storage.getDirectory(),TAR_TYPES=[{description:"TAR archive (.tar)",accept:{"application/x-tar":".tar"}},{description:"GZip compressed TAR archive (.tar.gz)",accept:{"application/x-gzip":".tar.gz","application/gzip":".tar.gz"}}];async function skipOobe(){await rootFolder.getFileHandle(".ContentExists",{create:!0});const n=await rootFolder.getDirectoryHandle("Content",{create:!0});for(const e of["Fonts","Images","Sound"])await n.getDirectoryHandle(e,{create:!0})}self.skipOobe=skipOobe;async function copyFile(n,e){const t=await n.getFile().then(a=>a.stream()),s=await(await e.getFileHandle(n.name,{create:!0})).createWritable();await t.pipeTo(s)}async function countFolder(n){let e=0;async function t(r){for await(const[s,a]of r)a.kind==="file"?e++:await t(a)}return await t(n),e}async function countFolderForBadBrowsers(n){let e=0;async function t(r){const s=r.createReader(),a=await new Promise((l,c)=>{s.readEntries(l,c)});for(const l of a)l.isFile?e++:await t(l)}return await t(n),e}async function copyFolder(n,e,t){async function r(a,l){for await(const[c,_]of a)if(_.kind==="file")await copyFile(_,l),t&&t(c);else{const p=await l.getDirectoryHandle(c,{create:!0});await r(_,p)}}const s=await e.getDirectoryHandle(n.name,{create:!0});await r(n,s)}async function copyFolderForBadBrowsers(n,e,t){async function r(a,l){const c=a.createReader(),_=await new Promise((p,O)=>{c.readEntries(p,O)});for(const p of _)if(p.isFile){const O=p,$=await(await l.getFileHandle(O.name,{create:!0})).createWritable();O.file(b=>b.stream().pipeTo($)),t&&t(O.name)}else{const O=p,D=await l.getDirectoryHandle(O.name,{create:!0});await r(O,D)}}const s=await e.getDirectoryHandle(n.name,{create:!0});await r(n,s)}async function hasContent(){try{const n=await rootFolder.getDirectoryHandle("Content",{create:!1});for(const e of["Fonts","Images","Sounds"])try{await n.getDirectoryHandle(e,{create:!1})}catch{return!1}return await rootFolder.getFileHandle(".ContentExists",{create:!1}),!0}catch{return!1}}async function createEntry(n,e,t){let r=null,s=null;const a=new Promise((c,_)=>{r=c,s=_}),l=n.entry(e,c=>{c?s(c):r()});if(t){const c=t.getReader();for(;;){const{value:_,done:p}=await c.read();if(p||!_)break;l.write(_)}l.end()}else l.end();await a}function createTar(n,e){const t=tar.pack();async function r(s,a){for await(const[l,c]of a)if(e&&e(c.kind,l),c.kind=="file"){const _=await c.getFile(),p=_.stream();await createEntry(t,{name:s+l,type:c.kind,size:_.size},p)}else await createEntry(t,{name:s+l,type:c.kind}),await r(s+l+"/",c)}return r("",n).then(()=>t.finalize()),toWeb(t)}async function extractTar(n,e,t){const r=fromWeb(n),s=tar.extract();s.on("entry",async(l,c,_)=>{const p=toWeb(c);async function O(){const b=p.getReader();for(;;){const{done:P,value:B}=await b.read();if(P||!B)break}}const D=l.name.split("/");if(D[D.length-1]===""&&D.pop(),D[0]===e.name&&D.shift(),D.length===0){await O(),_();return}let $=e;for(const b of D.splice(0,D.length-1))$=await $.getDirectoryHandle(b,{create:!0});if(l.type==="directory")await $.getDirectoryHandle(D[0],{create:!0}),await O(),t&&t("directory",D[0]);else if(l.type==="file"){const P=await(await $.getFileHandle(D[0],{create:!0})).createWritable();await p.pipeTo(P),t&&t("file",D[0])}else await O();_()});const a=new Promise((l,c)=>{s.on("finish",()=>l()),s.on("error",_=>c(_))});r.pipe(s),await a}async function recursiveGetDirectory(n,e){return e.length===0?n:recursiveGetDirectory(await n.getDirectoryHandle(e[0]),e.slice(1))}const OpfsExplorer=function(){this.path=rootFolder,this.components=[],this.entries=[],this.uploading=!1,this.downloading=!1,this.css=`
		display: flex;
		flex-direction: column;
		gap: 1em;
		flex: 1;

		.path {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			margin: 0 0.5rem;
		}
		.path h3 {
			font-family: var(--font-mono);
			margin: 0;
		}

		.entries {
			display: flex;
			flex-direction: column;
			gap: 0.5em;
		}

		.entry {
			display: flex;
			align-items: center;
			gap: 0.5rem;

			font-family: var(--font-mono);
		}

		.entry > svg {
			width: 1.5rem;
			height: 1.5rem;
		}

		.editor {
			display: flex;
			flex-direction: column;
			gap: 0.5em;
		}
		.editor .controls {
			display: flex;
			gap: 0.5em;
			align-items: center;
		}
		.editor .controls .name {
			font-family: var(--font-mono);
		}
		.editor textarea {
			min-height: 16rem;
			background: var(--bg-sub);
			color: var(--fg);
			border: 2px solid var(--surface4);
			border-radius: 0.5rem;
		}

		.expand { flex: 1 }
		.hidden { visibility: hidden }

		.archive {
			display: flex;
			flex-direction: row;
			gap: 0.5em;

		}

		.archive > * {
			flex: 1;
		}
	`,useChange([this.open],()=>this.path=this.path),useChange([this.path],async()=>{this.components=await rootFolder.resolve(this.path)||[];let l=[];this.components.length>0&&l.push({name:"..",entry:await recursiveGetDirectory(rootFolder,this.components.slice(0,this.components.length-1))});for await(const[c,_]of this.path)l.push({name:c,entry:_});l.sort((c,_)=>{const p=c.entry.kind.localeCompare(_.entry.kind);return p===0?c.name.localeCompare(_.name):p}),this.entries=l});const n=async()=>{const l=await showOpenFilePicker({multiple:!0});this.uploading=!0;for(const c of l)await copyFile(c,this.path);this.path=this.path,this.uploading=!1},e=async()=>{const l=await showDirectoryPicker();this.uploading=!0,await copyFolder(l,this.path),this.path=this.path,this.uploading=!1},t=async()=>{const l=this.components.at(-1)||"terraria-wasm",c=await showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:l+".tar",types:TAR_TYPES});this.downloading=!0;let _=createTar(this.path,(O,D)=>console.log(`tarring ${O} ${D}`));c.name.endsWith(".gz")&&(_=_.pipeThrough(new CompressionStream("gzip")));const p=await c.createWritable();await _.pipeTo(p),this.downloading=!1},r=async()=>{const l=await showOpenFilePicker({multiple:!0});this.uploading=!0;for(const c of l){let _=await c.getFile().then(p=>p.stream());c.name.endsWith(".gz")&&(_=_.pipeThrough(new DecompressionStream("gzip"))),await extractTar(_,this.path,(p,O)=>console.log(`untarring ${p} ${O}`))}this.uploading=!1},s=use(this.uploading,l=>l||PICKERS_UNAVAILABLE),a=use(this.downloading,l=>l||PICKERS_UNAVAILABLE);return h("div",null,h("div",{class:"path"},$if(use(this.components,l=>l.length>0),h(Button,{type:"normal",icon:"full",disabled:!1,"on:click":async()=>{this.path=this.entries[0].entry},title:"Up A Level"},h(Icon,{icon:data$7}))),h("h3",null,use(this.components,l=>l.length==0?"Root Directory":"/"+l.join("/"))),h("div",{class:"expand"}),h(Button,{type:"normal",icon:"full",disabled:s,"on:click":n,title:"Upload File"},h(Icon,{icon:data$b})),h(Button,{type:"normal",icon:"full",disabled:s,"on:click":e,title:"Upload Folder"},h(Icon,{icon:data$a}))),$if(use(this.uploading),h("span",null,"Uploading files...")),$if(use(this.downloading),h("span",null,"Downloading files...")),h("div",{class:"entries"},use(this.entries,l=>l.filter(c=>c.name!="..").map(c=>{const _=c.entry.kind==="directory"?data$h:data$g,p=async $=>{$.stopImmediatePropagation(),this.editing?.name===c.name&&(this.editing=null),await this.path.removeEntry(c.name,{recursive:!0}),this.path=this.path},O=async $=>{if($.stopImmediatePropagation(),c.entry.kind==="file"){const P=await c.entry.getFile(),B=URL.createObjectURL(P),x=document.createElement("a");x.href=B,x.download=c.name,x.click(),await new Promise(z=>setTimeout(z,100)),URL.revokeObjectURL(B)}},D=()=>{c.entry.kind==="directory"?(this.editing=null,this.path=c.entry):this.editing=c.entry};return h(Button,{"on:click":D,icon:"none",type:"listitem",disabled:!1,class:"entry"},h(Icon,{icon:c.name==".."?data$a:_}),h("span",null,c.name===".."?"Parent Directory":c.name),h("div",{class:"expand"}),h(Button,{class:c.entry.kind!=="file"?"hidden":"","on:click":O,icon:"full",type:"listaction",disabled:!1,title:"Download File"},h(Icon,{icon:data$f})),h(Button,{class:c.name===".."?"hidden":"","on:click":p,icon:"full",type:"listaction",disabled:!1,title:"Delete File"},h(Icon,{icon:data$e})))}))),use(this.editing,l=>{if(l){const c=h("textarea",null);c.value="Loading file...",l.getFile().then(p=>p.text()).then(p=>c.value=p);const _=async()=>{const p=await l.createWritable();await p.write(c.value),await p.close(),this.editing=null};return h("div",{class:"editor"},h("div",{class:"controls"},h("div",{class:"name"},l.name),h("div",{class:"expand"}),h(Button,{"on:click":_,icon:"left",type:"primary",disabled:!1},h(Icon,{icon:data$c}),"Save"),h(Button,{"on:click":()=>this.editing=null,icon:"full",type:"normal",disabled:!1},h(Icon,{icon:data$d}))),c)}}),h("div",{style:{flexGrow:1}}),h("div",{class:"archive"},h(Button,{type:"normal",icon:"full",disabled:s,"on:click":r},h(Icon,{icon:data$8})," Upload Folder Archive"),h(Button,{type:"normal",icon:"full",disabled:a,"on:click":t},h(Icon,{icon:data$9})," Download Folder Archive")))},Dialog=function(){return this.css=`
		display: flex;
		flex-direction: column;
		gap: 0.8rem;

		background: var(--bg);
		color: var(--fg);
		border: 1.25px solid var(--surface3);
		border-radius: 1.5rem;

		width: min(40rem, 100%);
		min-height: min(50rem, 100%);
		max-height: min(50rem, 100%);

		position: fixed;
		inset: 0;
		opacity: 0;

		scale: .9;
		transform: rotate3d(1, 0, 0, -20deg);
		filter: brightness(1.5);

		pointer-events: none;
		transition: opacity 0.25s, transform 0.175s, filter 0.2s, scale 0.2s, background 0.1s, border-color 0.1s;
		transition-timing-function: ease;
		transition-delay: 0.05s, 0.05s, 0.05s, 0.05s;
		transform-origin: 50% 0%;
		perspective: 1250px;

		&[open] {
			opacity: 1;
			transform: rotate3d(1,0,0,0deg);
			filter: brightness(1.0);
			transition-delay: 0.05s, 0.05s, 0.05s, 0.2s;
			pointer-events: auto;
		}

		&[open]::backdrop {
			background: rgba(32, 28, 28, 0.35);
		}

		&::backdrop {
			background: rgba(32, 28, 28, 0);
			transition: background 0.2s;
		}

		.header {
			display: flex;
			gap: 0.5rem;
			align-items: center;
			border-bottom: 1.8px solid var(--surface2);
			transition: border-color 0.1s ease;
			padding-bottom: 0.5rem;
			user-select: none;
			-webkit-user-select: none;
		}

		.header h2 {
			margin: 0;
		}

		.children {
			overflow-y: scroll;
			overflow-x: hidden;
			scrollbar-width: none;
			scrollbar-color: transparent transparent;
			flex: 1;
			display: flex;
			flex-direction: column;
		}

		.expand { flex: 1 }
	`,this.mount=()=>{const n=this.root;useChange([this.open],()=>{this.open?n.showModal():n.close()})},h("dialog",{class:"component-dialog"},h("div",{class:"header"},h("h2",null,this.name),h("div",{class:"expand"}),h(Button,{"on:click":()=>{this.open=!1},type:"normal",icon:"full",disabled:!1,title:"Close"},h(Icon,{icon:data$d}))),h("div",{class:"children"},this.children))},data$6={width:24,height:24,body:'<path fill="currentColor" d="M8 19V5l11 7z"/>'},data$5={width:24,height:24,body:'<path fill="currentColor" d="M3 21v-5h2v3h3v2zm13 0v-2h3v-3h2v5zM3 8V3h5v2H5v3zm16 0V5h-3V3h5v5z"/>'},data$4={width:24,height:24,body:'<path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8H4v10l2.4-8h17.1l-2.575 8.575q-.2.65-.737 1.038T19 20z"/>'},NAME="terrarium",Logo=function(){return this.css=`
		display: flex;
		align-items: center;
		font-size: 1.5rem;

		font-family: Andy Bold;

		img {
			image-rendering: pixelated;
			-ms-interpolation-mode: nearest-neighbor;
			width: 3rem;
			height: 3rem;
		}

		.extras {
			align-self: start;
			padding: 0.25rem 0;
			font-size: 1rem;
			color: var(--fg6);

			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}
	`,h("div",null,h("img",{src:"/app.webp",alt:"Terraria icon"}),h("span",null,NAME))},TopBar=function(){return this.css=`
		padding: 0.5em;

		display: flex;
		align-items: stretch;
		gap: 0.5rem;

		.group {
			display: flex;
			align-items: center;
			gap: 1rem;
		}

		.expand { flex: 1; }

		@media (max-width: 750px) {
			& {
				flex-direction: column;
			}
			.group {
				justify-content: space-evenly;
			}
		}
	`,useChange([gameState.ready,gameState.playing],()=>{this.allowPlay=gameState.ready&&!gameState.playing}),h("div",null,h("div",{class:"group"},h(Logo,null)),h("div",{class:"expand"}),h("div",{class:"group"},h(Button,{"on:click":()=>this.fsOpen=!0,icon:"full",type:"normal",disabled:!1,label:"File System"},h(Icon,{icon:data$4})),h(Button,{"on:click":async()=>{try{navigator.keyboard.lock(),await this.canvas.requestFullscreen({navigationUI:"hide"})}catch{}},icon:"full",type:"normal",disabled:use(gameState.playing,n=>!n),label:"Fullscreen"},h(Icon,{icon:data$5})),h(Button,{"on:click":()=>{play()},icon:"left",type:"primary",disabled:use(this.allowPlay,n=>!n)},h(Icon,{icon:data$6}),"Play")))},BottomBar=function(){return this.css=`
		background: var(--bg);
		border-top: 2px solid var(--surface1);
		padding: 0.5rem;
		font-size: 0.8rem;

		display: flex;
		align-items: center;
		justify-content: space-between;

		span {
			text-align: center;
		}

		@media (max-width: 750px) {
			& {
				flex-direction: column;
				gap: 0.5rem;
			}
		}
	`,h("div",null,h("span",null,"Ported by ",h(Link,{href:"https://github.com/velzie"},"velzie")),h("span",null,"All game assets and code belong to"," ",h(Link,{href:"https://re-logic.com/"},"Re-Logic")," All rights reserved."))},GameView=function(){this.css=`
		aspect-ratio: 16 / 9;
		user-select: none;
		display: grid;
		grid-template-areas: "overlay";
		max-height: 90rem;

		div, canvas {
			grid-area: overlay;
			width: 100%;
			height: 100%;
		}

		div.started, canvas.stopped {
			display: none;
		}

		div {
			font-size: 2rem;
			font-weight: 570;

			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}

		canvas:fullscreen {
			border: none;
			border-radius: 0;
			background: black;
		}
	`;const n=use(gameState.playing,t=>t?"started":"stopped"),e=use(gameState.playing,t=>t?"canvas started":"canvas stopped");return this.start=async()=>{await preInit()},h("div",{class:"tcontainer"},h("div",{class:n},"Game not running."),h("canvas",{id:"canvas",class:e,"bind:this":use(this.canvas),"on:contextmenu":t=>t.preventDefault()}))},Main=function(){this.css=`
		width: 100%;
		height: 100%;
		background: url(/backdrop.webp);
		color: var(--fg);

		display: flex;
		flex-direction: column;
		overflow: scroll;

		.main {
			flex: 1;
			display: flex;
			flex-direction: column;
			padding: 1rem 0;

			gap: 1em;

			margin: auto;
			width: min(1300px, calc(100% - 2rem));
		}

		.main h2 {
			margin: 0;
		}
	`,this.fsOpen=!1;let n=h(GameView,{"bind:canvas":use(this.canvas)});return this.start=()=>n.$.start(),h("div",null,h(TopBar,{canvas:use(this.canvas),"bind:fsOpen":use(this.fsOpen)}),h("div",{class:"main"},n,h(LogView,null)),h(Dialog,{name:"File System","bind:open":use(this.fsOpen)},h(OpfsExplorer,{open:use(this.fsOpen)})),h(BottomBar,null))},TextField=function(){return this.css=`
		border: 0.1rem solid var(--surface1);
		border-radius: 4rem;
		padding: 0.5rem;
		font-family: var(--font-body);
		padding-left: 0.75rem;
		transition: all 0.1s ease;
		color: var(--fg);
		font-size: 1.25rem;

		&:hover {
			transition: all 0.1s ease;
			border-color: var(--surface2);
		}

		&:focus {
			transition: all 0.1s ease;
			border-color: var(--accent);
		}

		::placeholder {
			color: var(--surface5);
		}
	`,h("input",{type:this.type||"text",class:`component-textfield ${this.class} tcontainer`,placeholder:`${this.placeholder}`,"bind:value":use(this.value),"on:keydown":this["on:keydown"]||(()=>{})})},data$3={width:24,height:24,body:'<path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8H11.175l-2-2H4v12l2.4-8h17.1l-2.575 8.575q-.2.65-.737 1.038T19 20zm2.1-2H19l1.8-6H7.9zm0 0l1.8-6zM4 8V6z"/>'},data$2={width:24,height:24,body:'<path fill="currentColor" d="M11 20H6.5q-2.275 0-3.887-1.575T1 14.575q0-1.95 1.175-3.475T5.25 9.15q.625-2.3 2.5-3.725T12 4q2.925 0 4.963 2.038T19 11q1.725.2 2.863 1.488T23 15.5q0 1.875-1.312 3.188T18.5 20H13v-7.15l1.6 1.55L16 13l-4-4l-4 4l1.4 1.4l1.6-1.55z"/>'},data$1={width:24,height:24,body:'<path fill="currentColor" d="M16 12v-2h2v2zm0 2h-2v-2h2zm0 2v-2h2v2zm-4.825-8l-2-2H4v12h10v-2h2v2h4V8h-4v2h-2V8zM4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2V6z"/>'},data={width:24,height:24,body:'<path fill="currentColor" d="M10.5 15h3l-.575-3.225q.5-.25.788-.725T14 10q0-.825-.587-1.412T12 8t-1.412.588T10 10q0 .575.288 1.05t.787.725zm1.5 7q-3.475-.875-5.738-3.988T4 11.1V5l8-3l8 3v6.1q0 3.8-2.262 6.913T12 22"/>'},validateDirectory=async n=>{if(n.name!="Content")return"Directory name is not Content";for(const e of["Fonts","Images","Sounds"])try{await n.getDirectoryHandle(e,{create:!1})}catch{return`Failed to find subdirectory ${e}`}return""},validateDirectoryForBadBrowsers=async n=>{if(!n||!n.isDirectory)return"what?";let e=n;if(e.name!="Content")return"Directory name is not Content";let t=e.createReader();return new Promise(r=>{t.readEntries(s=>{for(const a of["Fonts","Images","Sounds"])if(!s.some(l=>l.name===a&&l.isDirectory)){r(`Failed to find subdirectory Content/${a}`);return}}),r("")})},Intro=function(){this.css=`
		display: flex;
		flex-direction: column;
		gap: 1rem;
		height:100%;
		font-family: Andy Bold;

		.warning {
			color: var(--warning);
		}
		.error {
			color: var(--error);
		}

		.buttons {
		  display: flex;
		  align-self: end;
		  gap: 1rem;
		  width: 100%;
		  div {
		    width: 100%;
		  }
		}

		@media (max-width: 825px) {
			.buttons {
				flex-direction: column;
				gap: 0.5rem;
			}
		}
	`;const n=e=>{this.starting=!0,this["on:next"](e)};return h("div",null,h("div",null,"This is a port of ",h(Link,{href:"https://terraria.org"},"Terraria")," to the browser with WebAssembly. Frontend and build system is heavily based on r58's"," ",h(Link,{href:"https://github.com/MercuryWorkshop/celeste-wasm"},"Celeste browser port"),"."),h("div",null,"A ",h(Link,{href:"https://mercurywork.shop"},"Mercury Workshop")," Project. Ported by ",h(Link,{href:"https://velzie.rip"},"velzie"),". Want to know more about how this was made? Check the"," ",h(Link,{href:"https://velzie.rip/blog/celeste-wasm/"},"writeup"),"!"),h("div",null,"You will need to own Terraria to play this. Make sure you either own it on Steam, or have it downloaded and installed on your computer."),PICKERS_UNAVAILABLE?h("div",{class:"error"},"Your browser does not support the"," ",h(Link,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/showDirectoryPicker"},"File System Access API"),". You will be unable to extract a ",NAME," archive to play or use the upload/download features in the filesystem viewer. Please switch to a chromium based browser."):null,FSAPI_UNAVAILABLE?h("div",{class:"error"},"Your browser does not support the"," ",h(Link,{href:"https://developer.mozilla.org/en-US/docs/Web/API/DataTransferItem/webkitGetAsEntry"},"File and Directory Entries API"),". You will be unable to copy game assets from your local install of Terraria."):null,h("div",null,"You will need to install Terraria to your browser with one of the following methods:"),h("div",{class:"buttons"},[h(Button,{"on:click":()=>n("copy"),type:"primary",icon:"left",disabled:use(this.starting,e=>e||FSAPI_UNAVAILABLE)},h(Icon,{icon:data$3}),FSAPI_UNAVAILABLE?"Copying local assets is unsupported":"Copy local assets"),h(Button,{"on:click":()=>this["on:next"]("download"),type:"primary",icon:"left",disabled:use(this.starting)},h(Icon,{icon:data$f}),"Download assets from Steam"),h(Button,{"on:click":()=>this["on:next"]("extract"),type:"primary",icon:"left",disabled:use(this.starting,e=>e||PICKERS_UNAVAILABLE)},h(Icon,{icon:data$9}),PICKERS_UNAVAILABLE?`Extracting ${NAME} archive is unsupported`:`Extract ${NAME} archive`)]))},Progress=function(){return this.css=`
		background: var(--surface1);
		border-radius: 1rem;
		height: 1rem;

		.bar {
			background: var(--accent);
			border-radius: 1rem;
			height: 1rem;
			transition: width 250ms;
		}
	`,h("div",null,h("div",{class:"bar",style:use`width:${this.percent}%`}))},Copy=function(){this.css=`
		display: flex;
		flex-direction: column;
		gap: 0.5rem;

		code {
			font-size: 18px;
		}

		.droparea {
			position: relative;
			border: 2px dashed color-mix(in srgb, var(--bg) 75%, var(--surface6));
			color: var(--fg6);
			font-size: 1.05rem;
			font-weight: 500;
			border-radius: 1rem;
			padding: 2rem;
			text-align: center;
			background: color-mix(in srgb, var(--bg) 45%, transparent);
			transition: border-color 0.2s ease;
		}

		.droparea.true {
			pointer-events: none;
			cursor: no-drop;

			* {
				cursor: no-drop;
			}

			background:  color-mix(in srgb, var(--bg-sub) 45%, transparent);
			color: var(--surface6);
			border-color: color-mix(in srgb, var(--bg) 75%, var(--surface4));
		}

		.droparea.dragover {
			border-color: var(--accent);
			color: color-mix(in srgb, var(--fg3) 92%, var(--accent));
			.dnd-bg-hover {
				transition: background-image 0.35s ease;
				background-image: radial-gradient(
					circle at center,
					color-mix(in srgb, var(--accent) 25%, transparent),
					transparent
				);
			}
		}

		.dnd-bg-hover {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			border-radius: 1rem;
			z-index: 9;
			transition: background-image 0.35s ease;
			background-image: radial-gradient(
				circle at center,
				color-mix(in srgb, var(--surface3) 5%, transparent),
				transparent
			);
		}

		.dnd-content {
			z-index: 10;
			position: relative;
		}

		.dnd-icon {
			font-size: 2.65rem;
		}
	`;const n=async()=>{const t=await showDirectoryPicker(),r=await validateDirectory(t);if(r){this.status=r;return}const s=await countFolder(t);let a=0;this.copying=!0;const l=performance.now();await copyFolder(t,rootFolder,_=>{a++,this.percent=a/s*100,console.debug(`copied ${_}: ${(a/s*100).toFixed(2)}`)});const c=performance.now();console.debug(`copy took ${(c-l).toFixed(2)}ms`),await new Promise(_=>setTimeout(_,250)),await rootFolder.getFileHandle(".ContentExists",{create:!0}),this["on:done"]()},e=async t=>{let r;"getAsEntry"in t&&typeof t.getAsEntry=="function"?r=t.getAsEntry():r=t.webkitGetAsEntry();const s=await validateDirectoryForBadBrowsers(r);if(s){this.status=s;return}const a=r,l=await countFolderForBadBrowsers(a);let c=0;this.copying=!0;const _=performance.now();await copyFolderForBadBrowsers(a,rootFolder,O=>{c++,this.percent=c/l*100,console.debug(`copied ${O}: ${(c/l*100).toFixed(2)}`)});const p=performance.now();console.debug(`copy took ${(p-_).toFixed(2)}ms`),await new Promise(O=>setTimeout(O,250)),await rootFolder.getFileHandle(".ContentExists",{create:!0}),this["on:done"]()};return h("div",null,h("div",null,"Select your Terraria install's Content directory. It will be copied to browser storage and can be removed in the file manager."),h("div",null,"The Content directory for Steam installs of Terraria is usually located in one of these locations:",h("ul",null,h("li",null,h("code",null,"~/.steam/root/steamapps/common/Terraria ")),h("li",null,h("code",null,"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Terraria ")),h("li",null,h("code",null,"~/Library/Application Support/Steam/steamapps/common/Terraria")))),$if(use(this.copying),h(Progress,{percent:use(this.percent)})),h(Button,{"on:click":n,type:"primary",icon:"left",disabled:use(this.copying,t=>t||PICKERS_UNAVAILABLE)},h(Icon,{icon:data$3}),PICKERS_UNAVAILABLE?"Selecting Terraria Content directory is unsupported":"Select Terraria Content directory"),h("div",{class:use`droparea ${this.copying}`,"on:drop":async t=>{if((t.currentTarget||t.target)?.classList.remove("dragover"),t.preventDefault(),!t.dataTransfer||!t.dataTransfer.items||this.copying)return;const r=t.dataTransfer.items[0];await e(r)},"on:dragover":t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy",!this.copying&&(t.currentTarget||t.target).classList.add("dragover")},"on:dragleave":t=>{(t.currentTarget||t.target)?.classList.remove("dragover")}},h("div",{class:"dnd-bg-hover"}),h("div",{class:"dnd-content"},h(Icon,{icon:data$2,class:"dnd-icon"}),PICKERS_UNAVAILABLE?h("p",null,"Drag and drop Terraria Content directory"):h("p",null,"Or, drag and drop one here"))),$if(use(this.status),h("div",{class:"error"},use(this.status))))},Extract=function(){this.css=`
		/* hacky */
		.center svg {
			transform: translateY(15%);
		}
	`;const n=async()=>{const t=(await showOpenFilePicker({excludeAcceptAllOption:!0,types:TAR_TYPES}))[0],r=await t.getFile();let s=0;const a=r.size,c=r.stream().getReader(),_=this;let p=new ReadableStream({async pull(O){const{value:D,done:$}=await c.read();!D||$?O.close():(O.enqueue(D),s+=D.byteLength,_.percent=s/a*100)}});this.extracting=!0,t.name.endsWith(".gz")&&(p=p.pipeThrough(new DecompressionStream("gzip"))),await extractTar(p,rootFolder,(O,D)=>console.log(`untarred ${O} ${D}`)),this.extracting=!1,await rootFolder.getFileHandle(".ContentExists",{create:!0}),this["on:done"]()};return h("div",{class:"step"},h("p",{class:"center"},"Select a ",NAME," exported .tar archive of the root directory. You can create this on a browser with ",NAME," already set-up by clicking the archive button (",h(Icon,{icon:data$9}),") in the filesystem explorer while in the root directory."),$if(use(this.extracting),h(Progress,{percent:use(this.percent)})),h(Button,{"on:click":n,type:"primary",icon:"left",disabled:use(this.extracting,e=>e)},h(Icon,{icon:data$1}),"Select ",NAME," archive"),$if(use(this.status),h("div",{class:"error"},use(this.status))))},SimpleDownload=function(){return this.css=`
		/* hacky */
		.center svg {
			transform: translateY(15%);
		}
	`,this.mount=async()=>{try{let n=new URL(void 0,location.href).href,e=await realFetch(n);if(console.log(e),e.status!=200)throw new Error(`Failed to download file: ${e.status} ${e.statusText}`);let t=0;const r=parseInt(e.headers.get("Content-Length")),a=e.body.getReader(),l=this;let c=new ReadableStream({async pull(_){const{value:p,done:O}=await a.read();!p||O?_.close():(_.enqueue(p),t+=p.byteLength,l.percent=t/r*100)}});this.extracting=!0,n.endsWith(".gz")&&(c=c.pipeThrough(new DecompressionStream("gzip"))),await extractTar(c,rootFolder,(_,p)=>{console.log(`extracted ${_} ${p}`)}),this.extracting=!1,await rootFolder.getFileHandle(".ContentExists",{create:!0}),this["on:done"]()}catch(n){this.status=`Failed to download file: ${n}`,this.extracting=!1,console.error(n)}},h("div",{class:"step"},h("p",{class:"center"},"Downloading ",NAME," from the server"),$if(use(this.extracting),h(Progress,{percent:use(this.percent)})),$if(use(this.status),h("div",{class:"error"},use(this.status))))},Download=function(){this.username="",this.password="",this.css=`
		display: flex;
		flex-direction: column;
		gap: 1rem;
		font-size: 15pt;

		input[type="file"] {
			display: none;
		}

		.methods {
			display: flex;
			gap: 1rem;
		}
		.methods > div {
			flex: 1;
			display: flex;
			flex-direction: column;
			gap: 0.5rem;

			padding: 1rem;
		}
		input {
			color: var(--fg);
			background: var(--bg);
			border: 2px solid black;
			border-radius: 0.5em;
			padding: 0.25rem;

			font-family: Andy Bold;
			font-size: 18pt;
		}

		.spacer {
			flex: 1;
			margin-top: 0.5em;
			margin-bottom: 0.5em;
			border-bottom: 1px solid var(--fg);
		}

		h1, h3 {
			text-align: center;
			font-family: Andy Bold;
			padding: 0;
			margin: 0;
		}
		.logcontainer {
			font-size: initial;
		}

		.qrcontainer {
			display: flex;
			justify-content: center;
			flex-direction: column;
			align-items: center;
			width: 100%;
		}
		.qrcontainer img {
			width: 40%;
		}
	`;const n=async()=>{gameState.loginstate=1,await initSteam(null,null,!0)!=0?gameState.loginstate=3:gameState.loginstate=2},e=async()=>{gameState.loginstate=1,await initSteam(this.username,this.password,!1)!=0?(this.username="",this.password="",gameState.loginstate=3):gameState.loginstate=2},t=async()=>{this.downloading=!0,await downloadApp()};return h("div",null,h("h1",null,"Steam Login"),h("div",null,"This will log into Steam through a proxy, so that it can download Terraria assets and achievement stats ",h("br",null),"The account details are encrpyted on your device and never sent to a server. Still, beware of unofficial deployments"),$if(use(gameState.loginstate,r=>r==0||r==3),h("div",{class:"methods"},h("div",{class:"tcontainer"},h("h3",null,"Username and Password"),h("input",{"bind:value":use(this.username),placeholder:"Username"}),h("input",{"bind:value":use(this.password),type:"password",placeholder:"Password"}),h(Button,{type:"primary",icon:"left",disabled:use(this.downloading),"on:click":e},h(Icon,{icon:data}),"Log In with Username and Password")),h("div",{class:"tcontainer"},h("h3",null,"Steam Guard QR Code"),"Requires the Steam app on your phone to be installed. ",h("br",null),h("div",{style:"flex: 1"}),h(Button,{type:"primary",icon:"left",disabled:use(this.downloading),"on:click":n},h(Icon,{icon:data}),"Log In with QR Code")))),$if(use(gameState.loginstate,r=>r==3),h("div",{style:"color: var(--error)"},"Failed to log in! Try again")),$if(use(gameState.loginstate,r=>r==3||r==1||r==2),h("div",{class:"logcontainer"},h(LogView,null))),$if(use(gameState.loginstate,r=>r==1),h("div",{class:"qrcontainer"},h("p",null,"Since this uses a proxy, the steam app might complain about your location being wrong. Just select the location that you don't usually log in from if it asks"),$if(use(gameState.qr),h("img",{src:use(gameState.qr)})),$if(use(gameState.qr),h("div",null,"Scan this QR code with the Steam app on your phone.")))),$if(use(gameState.loginstate,r=>r==2),h("div",null,h(Button,{type:"primary",icon:"left",disabled:use(this.downloading),"on:click":t},h(Icon,{icon:data}),"Download assets"))),$if(use(this.downloading),h(Progress,{percent:use(this.percent)})))},Splash=function(){return this.css=`
		position: relative;

		.splash, .blur, .main {
			position: absolute;
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
		}

		.splash {
			object-fit: cover;
			z-index: 1;
		}

		.blur {
			backdrop-filter: blur(0.5vw);
			z-index: 2;
		}

		.main {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			z-index: 3;
			padding: 0.5em;
		}

		.container {
			backdrop-filter: blur(0.5vw);
			width: min(50rem, 100%);
			margin: 0 1rem;
			padding: 1em;
			font-size: 18pt;

			color: var(--fg);

			display: flex;
			flex-direction: column;
			gap: 0.5rem;
		}

		.logo {
			display: flex;
			justify-content: center;
		}

		.wisp {
			display: flex;
			gap: 0.5em;
			align-items: center;
		}
		.wisp input {
			flex: 1;
		}

		.logo {
			display: flex;
			align-items: center;
		}

		.logo img {
			width: 100%;
			height: auto;
			aspect-ratio: 3.01;
		}
	`,this.next="",h("div",null,h("img",{class:"splash",src:"/backdrop.webp",alt:"Terraria art background"}),h("div",{class:"blur"}),h("div",{class:"main"},h("div",{class:"logo"},h("img",{src:"/logo.webp",alt:"Terraria logo",width:"421",height:"140",fetchpriority:"high"})),h("div",{class:"container tcontainer"},use(this.next,n=>{if(n){if(n==="copy")return h(Copy,{"on:done":this["on:next"]});if(n==="extract")return h(Extract,{"on:done":this["on:next"]});if(n==="simpledownload")return h(SimpleDownload,{"on:done":this["on:next"]});if(n==="download")return h(Download,{"on:done":this["on:next"]})}else return h(Intro,{"on:next":async e=>{await this.start(),this.next=e}})}),h("div",{class:"wisp"},h("span",null,"Wisp Proxy Server:"),h(TextField,{"bind:value":use(store.wisp)})))))},initialHasContent=await hasContent(),App=function(){this.css=`
		position: relative;

		div {
			position: absolute;
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
		}
		#splash {
			z-index: 1;
		}

		@keyframes fadeout {
			from { opacity: 1; scale: 1; }
			to { opacity: 0; scale: 1.2; }
		}
	`;let n=h(Main,null);const e=()=>n.$.start(),t=()=>{this.el.addEventListener("animationend",this.el.remove),this.el.style.animation="fadeout 0.5s ease",e()};return this.mount=()=>{initialHasContent&&e()},h("div",{id:"app",class:"dark"},initialHasContent?null:h("div",{id:"splash","bind:this":use(this.el)},h(Splash,{"on:next":t,start:e})),h("div",{id:"main"},n))},root=document.getElementById("app");try{root.replaceWith(h(App,null))}catch(n){console.log(n),root.replaceWith(document.createTextNode(`Failed to load: ${n}`))}
